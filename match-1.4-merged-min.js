var M=window.M||{};
(function(f){function e(){var a="Firefox;Chrome;Opera;Safari;MSIE 9.0;BlackBerry".split(";"),d,b;this.name=void 0;for(d in a)b=a[d],this["is"+b]=-1!=navigator.userAgent.indexOf(b),!this.name&&this["is"+b]&&(this.name=b);this.supportedAudioFormat=this.getBrowserPreferredAudioFormat();this.supported=void 0!=this.name}function b(){var a="Android BlackBerry iPhone iPad iPod IEMobile".split(" "),d;for(d in a)deviceName=a[d],this["is"+deviceName]=-1!=navigator.userAgent.indexOf(deviceName),!this.name&&
this["is"+deviceName]&&(this.name=deviceName);this.name?this.isMobile=!0:(this.isMobile=!1,this.name="PC")}function d(){window.requestAnimFrame(d);window.Match.gameLoop()}function a(){this._isPlaying=!1;this._gameLayers=[];this._gameObjects=[];this._gameObjectsToAdd=[];this.cache=null;this.offScreenCanvas=document.createElement("canvas");this.offScreenContext=this.offScreenCanvas.getContext("2d");this.onLoopProperties={offScreenContext:this.offScreenContext,offScreenCanvas:this.offScreenCanvas,debug:!1,
time:0};this.browser=new e;this.device=new b;this.setDoubleBuffer(!1);var a=this;document.addEventListener("DOMContentLoaded",function(){a.setUpGameLoop()})}f.Match||(e.prototype.getBrowserPreferredAudioFormat=function(){var a=document.createElement("audio");if(""!=a.canPlayType("audio/ogg"))return".ogg";if(""!=a.canPlayType("audio/mpeg"))return".mp3";if(""!=a.canPlayType("audio/wav"))return".wav";if(""!=a.canPlayType("audio/mp4"))return".mp4";console.warn("This browser does not support audio")},
e.prototype.getBrowserAudioSupportedFormats=function(){var a=document.createElement("audio"),d=[];""!=a.canPlayType("audio/ogg")&&d.push(".ogg");""!=a.canPlayType("audio/mpeg")&&d.push(".mp3");""!=a.canPlayType("audio/wav")&&d.push(".wav");""!=a.canPlayType("audio/mp4")&&d.push(".mp4");return d.join("|")},a.prototype.setUpGameLoop=function(){this.gameLoopAlreadySetup=!0;d();"function"==typeof window.main&&window.main()},a.prototype.setDebug=function(a){this.onLoopProperties.debug=a},a.prototype.setKeyboard=
function(a){this.keyboard=a;this.onLoopProperties.keyboard=a;this._buildInputMapping()},a.prototype.setMouse=function(a){this.mouse=a;this.onLoopProperties.mouse=a;this._buildInputMapping()},a.prototype.setTouch=function(a){this.touch=a;this.onLoopProperties.touch=a;this._buildInputMapping()},a.prototype.setAccelerometer=function(a){this.accelerometer=a;this.onLoopProperties.accelerometer=a;this._buildInputMapping()},a.prototype.setOrientation=function(a){this.orientation=a;this.onLoopProperties.orientation=
a;this._buildInputMapping()},a.prototype.renderSingleBuffer=function(a,d,b){var e=a.length,f=0,k=this.frontBuffer;for(k.clearRect(0,0,d.width,d.height);f<e;f++)k.drawImage(a[f].onLoop(b),0,0)},a.prototype.renderDoubleBuffer=function(a,d,b){var e=a.length,f=0,k,q=this.backBuffer;for(q.clearRect(0,0,d.width,d.height);f<e;f++){k=a[f];var r=k.onLoop(b);q.save();k.composite&&(q.globalCompositeOperation=k.composite);null!=k._alpha&&(0<=k._alpha&&1>=k._alpha)&&(q.globalAlpha=k._alpha);q.translate(q.halfWidth,
q.halfHeight);k.rotation&&q.rotate(k.rotation);k.scale&&q.scale(k.scale.x,k.scale.y);q.drawImage(r,-q.halfWidth,-q.halfHeight);q.restore()}this.frontBuffer.clearRect(0,0,d.width,d.height);this.frontBuffer.drawImage(q.canvas,0,0);this.pepe=!0},a.prototype.updateGameObjects=function(a,d){for(var b in a){var e=a[b];this._applyInput&&this._applyInput(d,e);if(e.onLoop)e.onLoop(d);e.children&&this.updateGameObjects(e.children,d)}},a.prototype._buildInputMapping=function(){var a=this.onLoopProperties,d=
"",b="";a.keyboard&&(d+="p.keyboard.applyToObject(node);",b+="p.keyboard.update();");a.mouse&&(d+="p.mouse.applyToObject(node);",b+="p.mouse.update();");a.touch&&(d+="p.touch.applyToObject(node);",b+="p.touch.update();");a.accelerometer&&(d+="p.accelerometer.applyToObject(node);",b+="p.accelerometer.update();");a.orientation&&(d+="p.orientation.applyToObject(node);",b+="p.orientation.update();");this._applyInput=new Function("p","node",d);this._updateInput=new Function("p",b)},a.prototype.gameLoop=
function(){if(this._isPlaying){if(this.onBeforeLoop)this.onBeforeLoop();var a=this.onLoopProperties;a.time=this.FpsCounter.timeInMillis;this.updateGameObjects(this._gameObjects,a);this._updateInput&&this._updateInput(a);this.render(this._gameLayers,this.frontBuffer.canvas,a);a.debug&&(this.frontBuffer.font="18px sans-serif",this.frontBuffer.fillStyle="yellow",this.frontBuffer.fillText(this.getFps()+"fps",20,20));this.FpsCounter.count();if(this.onAfterLoop)this.onAfterLoop()}},a.prototype.getAsBase64Image=
function(){return this.frontBuffer.canvas.toDataURL()},a.prototype.getAsImage=function(){var a=new Image;a.src=this.getAsBase64Image();return a},a.prototype.getFirst=function(){return this.getIndex(0)},a.prototype.getIndex=function(a){try{return this._gameObjects[a]}catch(d){return null}},a.prototype.get=function(a){if(this.cache&&this.cache.key==a)return this.cache;for(var d=this._gameObjects.length,b;d--;)if(b=this._gameObjects[d],a==b.key)return this.cache=b;return null},a.prototype.getLast=function(){return this.getIndex(this._gameObjects.length-
1)},a.prototype.isInOnLoopList=function(a){return-1!=this._gameObjects.indexOf(a)},a.prototype.push=function(a){a instanceof this.Layer?this.pushLayer(a):this.pushObject(a)},a.prototype.pushGameObject=function(a){if(!a.onLoop)throw Error("Cannot add object "+a.constructor.name+", it doesn't have an onLoop method");this._gameObjects.push(a)},a.prototype.pushObject=a.prototype.pushGameObject,a.prototype.removeGameObject=function(a){void 0!=a&&("string"==typeof a?this.removeGameObject(this.get(a)):isNaN(a)?
(a=this._gameObjects.indexOf(a),-1!=a&&this._gameObjects.splice(a,1)):this._gameObjects.splice(a,1))},a.prototype.removeAllGameObjects=function(){this._gameObjects=[]},a.prototype.createNewContext=function(){return window.document.createElement("canvas").getContext("2d")},a.prototype.setDoubleBuffer=function(a){a?(this.backBuffer=this.createNewContext(),this.updateBufferSize(),this.render=this.renderDoubleBuffer):this.render=this.renderSingleBuffer},a.prototype.isDoubleBuffered=function(){return this.render==
this.renderDoubleBuffer},a.prototype.setCanvasSize=function(a,d){this.frontBuffer&&(this.frontBuffer.canvas.width=a,this.frontBuffer.canvas.height=d,this.updateBufferSize())},a.prototype.updateBufferSize=function(){this.frontBuffer&&(this.backBuffer&&this.frontBuffer&&(this.backBuffer.canvas.width=this.frontBuffer.canvas.width,this.backBuffer.canvas.height=this.frontBuffer.canvas.height,this.backBuffer.halfWidth=this.backBuffer.canvas.width/2,this.backBuffer.halfHeight=this.backBuffer.canvas.height/
2),this.offScreenCanvas.width=this.frontBuffer.canvas.width,this.offScreenCanvas.height=this.frontBuffer.canvas.height,this.collisions.PixelPerfect&&(this.collisions.PixelPerfect.testContext.canvas.width=this.offScreenCanvas.width,this.collisions.PixelPerfect.testContext.canvas.height=this.offScreenCanvas.height),this.updateViewport())},a.prototype.createGameLayer=function(){var a=new this.GameLayer;this.frontBuffer&&a.setBufferSize(this.frontBuffer.canvas);this.pushGameLayer(a);return a},a.prototype.createLayer=
a.prototype.createGameLayer,a.prototype.pushGameLayer=function(a){if(!a)throw Error("Cannot add null game layer");this.frontBuffer&&a.setBufferSize(this.frontBuffer.canvas);this._gameLayers.push(a)},a.prototype.pushLayer=a.prototype.pushGameLayer,a.prototype.removeScene=function(){var a=this._gameLayers;this.removeAllGameLayers();return a},a.prototype.pushScene=function(a){for(var d=0,b=a.length;d<b;d++)this.pushGameLayer(a[d])},a.prototype.swapScenes=function(a){a=this.removeScene();this.pushScene(a);
return a},a.prototype.removeGameLayer=function(a){a||(a=this._gameLayers[0]);this.removeElementFromArray(a,this._gameLayers);for(var d in a.onRenderList)this.removeGameObject(a.onRenderList[d])},a.prototype.removeAllGameLayers=function(){for(var a=0;a<this._gameLayers.length;a++){var d=this._gameLayers[a],b;for(b in d.onRenderList)this.removeGameObject(d.onRenderList[b])}this._gameLayers=[]},a.prototype.getSpeed=function(a){return a/this.getAverageFps()},a.prototype.getSpeedFixedAt=function(a,d){var b=
this.getAverageFps();return a/b*(d/b)},a.prototype.getFps=function(){return this.FpsCounter.fps},a.prototype.getAverageFps=function(){return this.FpsCounter.getAverageFps()},a.prototype.getGameTime=function(){return this.FpsCounter.gameTime},a.prototype.getTime=function(){return this.FpsCounter.timeInMillis},a.prototype.clearFrontBuffer=function(){this.frontBuffer&&this.frontBuffer.clearRect(0,0,this.frontBuffer.canvas.width,this.frontBuffer.canvas.height)},a.prototype.pause=function(){if(this._isPlaying){if(this.onPause)this.onPause()}else if(this.onUnPause)this.onUnPause();
this._isPlaying=!this._isPlaying},a.prototype.start=function(a,d){a||(a=M.dom("canvas"));if(!(a instanceof HTMLCanvasElement))throw Error("start is expecting an HTMLCanvasElement as argument");a.onselectstart=function(){return!1};a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullScreen;this.frontBuffer=a.getContext("2d");this.updateBufferSize();this.updateViewport();for(var b=0,e=this._gameLayers.length;b<e;b++)this._gameLayers[b].setBufferSize(a);
this._isPlaying=!0;this.gameLoopAlreadySetup||this.setUpGameLoop()},a.prototype.updateViewport=function(){this.camera.setViewport(this.frontBuffer.canvas.width,this.frontBuffer.canvas.height)},a.prototype.getViewportSize=function(){return{width:this.camera.viewportWidth,height:this.camera.viewportHeight}},a.prototype.removeIndexFromArray=function(a,d){d.splice(a,1)},a.prototype.removeElementFromArray=function(a,d){var b=d.indexOf(a);-1!=b&&this.removeIndexFromArray(b,d)},a.prototype.dom=function(a){return document.querySelector(a)},
a.prototype.applyProperties=function(a,d,b){if(a&&d){if(b){if(!d)throw Error("Cannot apply null properties to "+a.constructor.name);for(var e=b.length;e--;)if(!d[b[e]])throw Error("Unable to apply properties to ["+a.constructor.name+"] You must specify ["+b[e]+"]");}b="";for(e in d)if(b="set"+e.charAt(0).toUpperCase()+e.substr(1),a[b])a[b](d[e]);else a[e]=d[e];return a}},a.prototype.apply=function(){for(var a=arguments[0],d=1;d<arguments.length;d++){var b=arguments[d];if(b)if(b instanceof Function){var e=
new b,f;for(f in e)b.prototype[f]||a[f]||(a[f]=e[f])}else for(f in b)a[f]||(a[f]=b[f])}},a.prototype.put=function(a,d){for(var b in d)a[b]=d[b]},a.prototype.clone=function(a){for(var d in a)c[d]=a[d];return{}},a.prototype.each=function(a,d,b){var e=a.length;if(b)for(;e--;)d.call(b,a[e]);else for(;e--;)d.call(a[e])},a.prototype.extend=function(a,d){for(var b in d.prototype)a.prototype[b]||(a.prototype[b]=d.prototype[b])},a.prototype.round=function(a,d){for(var b="1";d--;)b+="0";d=parseInt(b);return Math.round(a*
d)/d},a.prototype.fastRound=function(a){return a>>0},a.prototype.getPercentage=function(a,d){return a*d/100},a.prototype.elapsedTimeFrom=function(a,d){return M.getTime()-a>=d},a.prototype.isPaused=function(){return!this._isPlaying},a.prototype.getStyleBySelector=function(a){var d=document.styleSheets,b,e,f;for(e=d.length-1;0<=e;e--)for(b=d[e].cssRules,f=0;f<b.length;f++)if(b[f].type==CSSRule.STYLE_RULE&&b[f].selectorText==a)return b[f].style;return null},a.prototype.setFullScreen=function(){this.frontBuffer&&
this.frontBuffer.canvas.requestFullScreen&&this.frontBuffer.canvas.requestFullScreen(Element.ALLOW_KEYBOARD_INPUT)},a.prototype.getSceneCenter=function(){return this.frontBuffer?this.frontBuffer.getCenter():{x:0,y:0}},a.prototype.setLoadingScene=function(a){this.prevLayers=M.removeScene();this.pushScene(a.getLayers())},a.prototype.getObjectName=function(a){if(!a||!a.constructor)return a;var d=a.constructor.name;d||(d=a.constructor.toString().match(/function ([a-zA-Z_$][a-zA-Z_$0-9]*)/)[1]);return d},
window.console?(window.console.log&&(window.console.debug=window.console.log),window.console.warn||(window.console.warn=window.console.debug)):(window.console={},window.console.log=window.console.debug=window.console.error=window.console.warning=function(){}),HTMLElement.prototype.remove=function(){this.parentNode.removeChild(this)},HTMLElement.prototype.setClass=function(a){this.setAttribute("class",a)},HTMLCanvasElement.prototype.getCenter=function(){return{x:this.width/2,y:this.height/2}},HTMLCanvasElement.prototype.setSize=
function(a,d){this.width=a;this.height=d},HTMLCanvasElement.prototype.adjustTo=function(a,d){this.style.setProperty("width",a+"px",null);this.style.setProperty("height",d+"px",null)},HTMLCanvasElement.prototype.adjustToAvailSize=function(){this.adjustTo(window.screen.availWidth+"px",window.screen.availHeight+"px")},HTMLCanvasElement.prototype.resizeKeepingAspect=function(a){this.adjustTo(this.width*a,this.height*a)},HTMLCanvasElement.prototype.getRight=function(){return this.offsetLeft+this.offsetWidth},
HTMLCanvasElement.prototype.getBottom=function(){return this.offsetTop+this.offsetHeight},HTMLCanvasElement.prototype.getAvailWidth=function(){return this.getRight()<window.screen.availWidth?this.offsetWidth:window.screen.availWidth-this.offsetLeft},HTMLCanvasElement.prototype.getAvailHeight=function(){return this.getBottom()<window.screen.availHeight?this.offsetHeight:window.screen.availHeight-this.offsetTop},HTMLCanvasElement.prototype.getViewport=function(){var a={};a.left=0>this.offsetLeft?-this.offsetLeft:
0;a.top=0>this.offsetTop?-this.offsetTop:0;a.right=this.offsetLeft+this.offsetWidth>window.screen.availWidth?window.screen.availWidth-this.offsetLeft:this.offsetWidth;a.bottom=this.offsetTop+this.offsetHeight>window.screen.availHeight?window.screen.availHeight-this.offsetTop:this.offsetHeight;return a},HTMLCanvasElement.prototype.getAspect=function(){var a={x:1,y:1};this.style.width&&this.width!=parseInt(this.style.width)&&(a.x=this.width/parseInt(this.style.width));this.style.height&&this.height!=
parseInt(this.style.height)&&(a.y=this.height/parseInt(this.style.height));return a},CanvasRenderingContext2D.prototype.resetOperation=function(){this.operationChanged&&"source-over"!=this.globalCompositeOperation&&(this.globalCompositeOperation="source-over",this.operationChanged=!1)},CanvasRenderingContext2D.prototype.resetAlpha=function(){this.alphaChanged&&1!=this.globalAlpha&&(this.globalAlpha=1,this.alphaChanged=!1)},CanvasRenderingContext2D.prototype.resetShadow=function(){this.shadowChanged&&
(0!=this.shadowBlur&&(this.shadowBlur=0),0!=this.shadowOffsetX&&(this.shadowOffsetX=0),0!=this.shadowOffsetY&&(this.shadowOffsetY=0),this.shadowChanged=!1)},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}(),f.M=f.Match=new a)})(window);(function(f){function e(){this.listeners=[]}e.prototype.addEventListener=function(b,d){d&&(b=b.bind(d));this.listeners.push(b)};e.prototype.raise=function(){for(var b=0,d=this.listeners.length;b<d;b++)this.listeners[b](arguments)};e.prototype.removeEventListener=function(b){b=this.listeners.indexOf(b);-1<b&&this.listeners.splice(b,1)};e.prototype.removeAllEventListeners=function(){this.listeners=[]};f.EventListener=e})(window.Match);(function(f){function e(){this.lastTime=(new Date).getTime();this._currentFps=0;this.fps="";this.gameTime=1;this.totalFps=this.timeInMillis=0}e.prototype.reset=function(){this.fps="";this.timeInMillis=this._currentFps=this.totalFps=0;this.gameTime=1};e.prototype.count=function(){this.timeInMillis=(new Date).getTime();1E3<=this.timeInMillis-this.lastTime?(this.lastTime=this.timeInMillis,this.fps=this._currentFps,this.gameTime++,this.totalFps+=this.fps,this._currentFps=0):this._currentFps++};e.prototype.getAverageFps=
function(){return 0==this.totalFps?60:Math.floor(this.totalFps/this.gameTime)};f.FpsCounter=new e})(window.Match);(function(f){function e(){this.hasFocus=!1;this.children={}}e.prototype.removeChild=function(b){this.children[b]=null};e.prototype.onLoop=function(){throw Error("Method GameObject.onLoop is abstract and must be overriden");};f.GameObject=e})(window.M);(function(f){function e(){this.math=Math}function b(d,a){this.x=d;this.y=a}e.prototype.getXFromCircle=function(d,a,b){return d+a*this.math.cos(b)};e.prototype.getYFromCircle=function(d,a,b){return d+a*this.math.sin(b)};e.prototype.getPointFromCircle=function(d,a,b,g){return this.getPointFromElipsis(d,a,b,b,g)};e.prototype.getPointFromElipsis=function(d,a,h,g,e){return new b(this.getXFromCircle(d,h,e),this.getYFromCircle(a,g,e))};e.prototype.getVector2d=function(d,a){return new b(a.x-d.x,a.y-d.y)};
e.prototype.getVector=function(d,a){return this.getVector2d(d,a)};e.prototype.getRotatedVertex=function(d,a){return new b(d.x*this.math.cos(a)-d.y*this.math.sin(a),d.y*this.math.cos(a)+d.x*this.math.sin(a))};e.prototype.getMagnitude=function(d){return this.math.sqrt(d.x*d.x+d.y*d.y)};e.prototype.getSquareDistance=function(d,a){var b=d.x-a.x,g=d.y-a.y;return b*b+g*g};e.prototype.getAngleBetweenVectors=function(d,a){var b=this.getMagnitude(d)*this.getMagnitude(a);return this.math.acos((d.x*a.x+d.y*
a.y)/b)};e.prototype.getCosBetweenVectors=function(d,a){var b=this.getMagnitude(d)*this.getMagnitude(a);return(d.x*a.x+d.y*a.y)/b};e.prototype.getDistance=function(d,a){return this.math.sqrt(this.getSquareDistance(d,a))};e.prototype.haveTheSameDirection=function(d,a){return 0<d.x&&0>a.x||0>d.x&&0<a.x||0<d.y&&0>a.y||0>d.y&&0<a.y?!1:!0};e.prototype.areParallelVectors=function(d,a){d=this.getNormalized(d);a=this.getNormalized(a);var b=d.x/a.x,g=d.y/a.y;return b>=g-0.1&&b<=g+0.1};e.prototype.getNormalized=
function(d){var a=this.getMagnitude(d);return new b(d.x/a,d.y/a)};e.prototype.substract=function(d,a){return new b(d.x-a.x,d.y-a.y)};e.prototype.add=function(d,a){return new b(d.x+a.x,d.y+a.y)};e.prototype.scalarProduct=function(d,a){return new b(d.x*a,d.y*a)};e.prototype.rotateIfNeeded=function(d,a,b){if(!this.areParallelVectors(d,a)||!this.haveTheSameDirection(d,a)){var g=this.getSquareDistance(d,a),e=this.getRotatedVertex(d,b);if(this.getSquareDistance(e,a)<g)return d.x=e.x,d.y=e.y,b;a=this.getRotatedVertex(d,
-b);d.x=a.x;d.y=a.y;return-b}return 0};f.math2d=f.Math2d=new e;f.math2d.Vector2d=b})(window.Match);(function(f,e){function b(d){this.objects=[];this.mode=null;this.setMode(d||"Polygon")}b.prototype={reset:function(){this.objects=[]},onLoop:function(){for(var d=0,a=1;d<this.objects.length;){for(;a<this.objects.length;)this.checkCollisions(this.objects[d],this.objects[a]),a++;d++;a=d+1}for(d=this.objects.length;d--;)this.objects[d]._visible||f.removeIndexFromArray(d,this.objects)},canCollide:function(d,a){if(d.cantCollideType)for(var b=d.cantCollideType.length;b--;)if(a instanceof d.cantCollideType[b])return!1;
if(d.cantCollide)for(b=d.cantCollide.length;b--;)if(d.cantCollide[b]==a)return!1;return!0},checkCollisions:function(d,a){if(this.canCollide(d,a)&&this.canCollide(a,d)&&this.mode.haveCollided(d,a)){if(d.onCollision)d.onCollision(a);if(a.onCollision)a.onCollision(d)}},setMode:function(d,a){this.mode="string"===typeof d?f.collisions[d]:d},push:function(d){this.objects.push(d)},removeType:function(d){for(var a=this.objects.length;a--;)this.objects[a]instanceof d&&this.remove(this.objects[a])}};e.AllvsAllCollisionHandler=
b})(window.Match,window.Match.collisions||(window.Match.collisions={}));(function(f,e){function b(d){this.colliders=[];this.collidables=[];this.setMode(d||"Polygon");this.collidableCallback=this.colliderCallback="onCollision"}b.prototype={onLoop:function(){for(var d=this.colliders.length;d--;)this.checkCollisions(this.colliders[d],this.collidables)},checkCollisions:function(d,a){if(d)for(var b=a.length,g=null;b--;){g=a[b];if(!g)break;if(g instanceof Array)this.checkCollisions(d,g);else if(this.mode.haveCollided(d,g)){if(d[this.colliderCallback])d[this.colliderCallback](g);
if(g[this.collidableCallback])g[this.collidableCallback](d)}}},setMode:function(d){this.mode="string"===typeof d?f.collisions[d]:d}};e.CollisionHandler=b})(window.Match,window.Match.collisions||(window.Match.collisions={}));(function(f,e){function b(){this.math2d=e}b.prototype={getCollisionArea:function(d){var a=[],b=d.getWidth()/2,g=d.getHeight()/2;a.push({x:-b,y:-g});a.push({x:b,y:-g});a.push({x:b,y:g});a.push({x:-b,y:g});this.rotate(a,d._rotation);this.translate(a,d._x,d._y);return a},translate:function(d,a,b){for(var g=0;g<d.length;g++)d[g].x+=a,d[g].y+=b},rotate:function(d,a){if(a)for(var b=0;b<d.length;b++)d[b]=this.math2d.getRotatedVertex(d[b],a)},haveCollided:function(b,a){for(var e=this.getCollisionArea(a),
g=this.getCollisionArea(b),m=0;m<g.length;m++)if(this.pointInPolygon(g[m].x,g[m].y,e)||this.pointInPolygon(e[m].x,e[m].y,g))return!0;return!1},pointInPolygon:function(b,a,e){var g,m,f=!1,p=e.length,k;g=0;for(m=p-1;g<p;m=g++)k=e[g],m=e[m],k.y>a!=m.y>a&&b<(m.x-k.x)*(a-k.y)/(m.y-k.y)+k.x&&(f=!f);return f}};f.Polygon=new b})(window.Match.collisions||(window.Match.collisions={}),window.Match.math2d);(function(f){function e(){}e.prototype={haveCollided:function(b,d){var a=0,e=0,a=b._halfWidth>b._halfHeight?b._halfWidth:b._halfHeight,e=d._halfWidth>d._halfHeight?d._halfWidth:d._halfHeight;return b._y+a<d._y-e||b._y-a>d._y+e||b._x+a<d._x-e||b._x-a>d._x+e?!1:!0}};f.Square=new e})(window.Match.collisions||(window.Match.collisions={}));(function(f,e){function b(b){this.math2d=e}b.prototype={haveCollided:function(b,a){var e=b.getWidth()*b.getHeight()/2,g=a.getWidth()*a.getHeight()/2,e=e<g?e:g;return this.math2d.getSquareDistance(b.getLocation(),a.getLocation())<=e*e}};f.Radial=new b})(window.Match.collisions||(window.Match.collisions={}),window.Match.math2d);(function(f){function e(){}e.prototype={haveCollided:function(b,d){return b.getBottom()<d.getTop()||b.getTop()>d.getBottom()||b.getRight()<d.getLeft()||b.getLeft()>d.getRight()?!1:!0}};f.Simple=new e})(window.Match.collisions||(window.Match.collisions={}));(function(f,e){function b(){this.testContext=document.createElement("canvas").getContext("2d")}b.prototype.haveCollided=function(b,a){var e=window.Math,g=e.min(b.getLeft(),a.getLeft()),m=e.min(b.getTop(),a.getTop()),f=e.max(b.getRight(),a.getRight())-g,p=e.max(b.getBottom(),a.getBottom())-m,k=this.testContext,q=e=0;k.clearRect(g,m,f,p);k.save();b.onRender(k,k.canvas,0,0);k.globalCompositeOperation="source-in";a.onRender(k,k.canvas,0,0);k.restore();for(g=k.getImageData(g,m,f,p);e<g.width;){for(;q<
g.height;){if(0!=g.data[4*(q*g.width+e)+3])return!0;q++}e++;q=0}return!1};e.PixelPerfect=new b})(window.Match,window.Match.collisions||(window.Match.collisions={}));(function(f){function e(){this._halfViewportWidth=this._halfViewportHeight=this.viewportHeight=this.viewportWidth=this.y=this.x=0}e.prototype.setViewport=function(b,d){this.viewportWidth=b;this.viewportHeight=d;this._halfViewportWidth=b/2;this._halfViewportHeight=d/2};e.prototype.centerAtRenderizable=function(b){this.x=b._x-this._halfViewportWidth;this.y=b._y-this._halfViewportHeight};e.prototype.centerAt=function(b,d){this.x=b-this._halfViewportWidth;this.y=d-this._halfViewportHeight};f.onLoopProperties.camera=
f.camera=new e})(window.Match);(function(f){function e(a){p.mousedown(a)}function b(a){p.mouseup(a)}function d(a){p.click(a)}function a(a){p.mousemove(a)}function h(a){p.mousewheel(a)}function g(a){p.DOMMouseScroll(a)}function m(a){a.preventDefault()}function n(){this.events={0:{},1:{},2:{}};this.y=this.x=null;this.isDragging=!1;f.browser.isFirefox?document.addEventListener("DOMMouseScroll",g,!1):"MSIE 9.0"==f.browser.name?document.addEventListener("onwheel",h,!1):document.addEventListener("mousewheel",h,!1);document.addEventListener("mousedown",
e,!1);document.addEventListener("mouseup",b,!1);document.addEventListener("mousemove",a,!1);document.addEventListener("click",d,!1)}var p;n.prototype={LEFT:0,MIDDLE:1,RIGHT:2,select:function(a){this.isDragging||(this.selectedObject=a)},preventContexMenu:function(a){a?document.addEventListener("contextmenu",m,!1):document.removeEventListener("contextmenu",m,!1)},fireEventOnLastSelectedObject:function(){var a=this.selectedObject,b=this.prevSelectedObject;if(a){a.onMouseIn&&!a._mouseInRaised&&(a._mouseInRaised=
!0,a.onMouseIn(this));if(b&&b!=a&&(b._mouseInRaised=!1,b.onMouseOut))b.onMouseOut(this);if(a.onMouseUp&&this.up())a.onMouseUp(this);if(a.onClick&&this.clicked())a.onClick(this);if(this.down()){if(a.onMouseDown)a.onMouseDown(this);this.isDragging=!0;if(a.onDrag)a.onDrag(this)}if(a.onMouseOver)a.onMouseOver(this);if(a.onMouseMove&&this.moved())a.onMouseMove(this);if(a.onMouseWheel&&this.wheel())a.onMouseWheel(this)}else b&&b.onMouseOut&&(b._mouseInRaised=!1,b.onMouseOut(this));this.prevSelectedObject=
a;this.isDragging||(this.selectedObject=null)},clicked:function(a){return null!=a?this.events[a].click:this.events[0].click},down:function(a){return null!=a?this.events[a].down:this.events[0].down||this.events[1].down||this.events[2].down},up:function(a){return null!=a?this.events[a].up:this.events[0].up||this.events[1].up||this.events[2].up},moved:function(){return this.eventMouseMove},wheel:function(){this.wheelDeltaY=0;this.eventMouseWheel&&(this.wheelDeltaY=this.eventMouseWheel.wheelDeltaY);return this.wheelDeltaY},
clear:function(){for(var a=0;3>a;a++)this.events[a].up=null,this.events[a].click=null;this.eventMouseMove=this.eventMouseWheel=null},click:function(a){this.events[a.button].click=a;this.x=a.offsetX;this.y=a.offsetY},mousedown:function(a){this.events[a.button].down=a},mouseup:function(a){this.events[a.button].down=null;this.events[a.button].up=a;this.isDragging=!1},mousewheel:function(a){this.eventMouseWheel=a},DOMMouseScroll:function(a){this.mousewheel({wheelDeltaY:-40*a.detail})},isOverPixelPerfect:function(a){if(a.onRender&&
a._visible){var b=f.offScreenContext,d=f.offScreenCanvas,g=f.camera;b.save();b.clearRect(0,0,d.width,d.height);a.onRender(b,d,g.x,g.y);a=b.getImageData(this.x,this.y,1,1);return a.data[3]?a.data[0]||a.data[1]||a.data[2]?!0:!1:!1}},isOverPolygon:function(a){var b=f.camera,d=this.x+b.x,b=this.y+b.y;return a._rotation?(this._x=d,this._y=b,f.collisions.Polygon.haveCollided(a,this)):a.getBottom()<b||a.getTop()>b||a.getRight()<d||a.getLeft()>d?!1:!0},getHeight:function(){return 2},getWidth:function(){return 2},
update:function(){this.fireEventOnLastSelectedObject();this.clear()},applyToObject:function(a){(a.onMouseOver||a.onMouseIn||a.onMouseOut||a.onMouseWheel||a.onMouseDown&&this.down()||a.onMouseUp&&this.up()||a.onClick&&this.clicked())&&this.isOverPolygon(a)&&this.isOverPixelPerfect(a)&&this.select(a)}};f.browser.isFirefox?(n.prototype.mousemove=function(a){this.eventMouseMove=a;this.x=a.layerX-a.target.offsetLeft;this.y=a.layerY-a.target.offsetTop},n.prototype.click=function(a){this.events[a.button].click=
a;this.x=a.layerX-a.target.offsetLeft;this.y=a.layerY-a.target.offsetTop}):n.prototype.mousemove=function(a){this.eventMouseMove=a;this.x=a.offsetX;this.y=a.offsetY};p=new n;f.setMouse(p)})(window.Match);(function(f){function e(a){d.accelerate(a)}function b(){window.addEventListener("devicemotion",e,!1)}var d;b.prototype.accelerate=function(a){this._hasEvent=!0;this.accelerationIncludingGravity=a.accelerationIncludingGravity;this.acceleration=a.acceleration;this.rotationRate=a.rotationRate};b.prototype.update=function(){this._hasEvent=!1};b.prototype.right=function(){return this._hasEvent&&(0<this.acceleration.x||0<this.accelerationIncludingGravity.x)};b.prototype.left=function(){return this._hasEvent&&
(0>this.acceleration.x||0>this.accelerationIncludingGravity.y)};b.prototype.up=function(){return this._hasEvent&&0<this.acceleration.y};b.prototype.down=function(){return this._hasEvent&&0>this.acceleration.y};b.prototype.applyToObject=function(a){if(this._hasEvent){if(a.onDeviceAccelerationIncludingGravity)a.onDeviceAccelerationIncludingGravity(this.accelerationIncludingGravity.x,this.accelerationIncludingGravity.y,this.accelerationIncludingGravity.z,this.rotationRate);if(a.onDeviceAcceleration)a.onDeviceAcceleration(this.acceleration.x,
this.acceleration.y,this.acceleration.z,this.rotationRate);if(a.onDeviceRotation)a.onDeviceRotation(this.rotationRate.alpha,this.rotationRate.beta,this.rotationRate.gamma)}};d=new b;f.setAccelerometer(d)})(window.Match);(function(f){function e(a){f.keyboard.fireDown(a)}function b(a){f.keyboard.fireUp(a)}function d(){document.addEventListener("keydown",e,!1);document.addEventListener("keyup",b,!1)}d.prototype={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",
122:"f11",123:"f12",145:"numlock",220:"pipe",keysDown:{length:0},keysUp:null,keysPressed:{},fireDown:function(a){a=this[a.which]||String.fromCharCode(a.which).toLowerCase();this.keysDown[a]=!0;void 0==this.keysPressed[a]&&(this.keysPressed[a]=!0);this.keysDown.length++},fireUp:function(a){a=this[a.which]||String.fromCharCode(a.which).toLowerCase();this.keysUp||(this.keysUp={});this.keysDown[a]=!1;this.keysPressed[a]=void 0;this.keysUp[a]=!0;0<this.keysDown.length&&this.keysDown.length--},update:function(){this.keysUp=
null;for(var a in this.keysPressed)!0==this.keysPressed[a]&&(this.keysPressed[a]=!1)},applyToObject:function(a){if(a.hasFocus){if(a.onKeyDown)a.onKeyDown(this.keysDown);if(a.onKeyUp)a.onKeyUp(this.keysUp);if(a.keyDownMappings&&0<this.keysDown.length)for(var b in a.keyDownMappings)if(this.keysDown[b])a[a.keyDownMappings[b]]();if(a.keyUpMappings&&this.keysUp)for(b in a.keyUpMappings)if(this.keysUp[b])a[a.keyUpMappings[b]]()}},getKeyCode:function(a){return a.charCodeAt(0)}};f.setKeyboard(new d)})(window.Match);(function(f){function e(a){h.start(a)}function b(a){h.end(a)}function d(a){h.move(a)}function a(){document.addEventListener("touchstart",e,!1);document.addEventListener("touchend",b,!1);document.addEventListener("touchmove",d,!1);this.y=this.x=0;this.isDragging=!1;this.events={start:null,end:null,move:null}}var h;a.prototype.clear=function(){this.events.end&&(this.events.start=null,this.y=this.x=0);this.events.end=null;this.force=this.events.move=null;this.isDragging||(this.selectedObject=null)};
a.prototype.update=function(){this.fireEventOnLastSelectedObject(this);this.clear()};a.prototype.getHeight=function(){return 2};a.prototype.getWidth=function(){return 2};a.prototype.applyToObject=function(a){!this.isDragging&&((a.onTouch||a.onTouchEnd||a.onTouchMove||a.onDrag)&&this.isOverPolygon(a)&&this.isOverPixelPerfect(a))&&(this.selectedObject=a)};a.prototype._setTouch=function(a){this.x=a.pageX-a.target.offsetLeft;this.y=a.pageY-a.target.offsetTop;this.force=a.force};a.prototype.start=function(a){a=
a.changedTouches;a.length&&(a=a[0],this._setTouch(a),this.events.start=a)};a.prototype.end=function(a){a=a.changedTouches;a.length&&(this.events.end=a[0],this.isDragging=!1,this.selectedObject=null)};a.prototype.move=function(a){a=a.changedTouches;a.length&&(a=a[0],this._setTouch(a),this.events.move=a)};a.prototype.started=function(){return this.events.start};a.prototype.moved=function(){return this.events.move};a.prototype.ended=function(){return this.events.end};a.prototype.any=function(){return this.started()||
this.moved()||this.ended()};a.prototype.fireEventOnLastSelectedObject=function(){if(this.selectedObject){if(this.events.start){if(this.selectedObject.onTouch)this.selectedObject.onTouch(this);this.selectedObject.onDrag&&(this.isDragging=!0)}if(this.events.end&&this.selectedObject.onTouchEnd)this.selectedObject.onTouchEnd(this);if(this.events.move){if(this.selectedObject.onTouchMove)this.selectedObject.onTouchMove(this);if(this.isDragging)this.selectedObject.onDrag(this)}}};a.prototype.isOverPixelPerfect=
function(a){if(a.onRender&&a._visible){var b=f.offScreenContext,d=f.offScreenCanvas,e=f.camera;b.save();b.clearRect(0,0,d.width,d.height);a.onRender(b,d,e.x,e.y);a=b.getImageData(this.x,this.y,1,1);return a.data[3]?a.data[0]||a.data[1]||a.data[2]?!0:!1:!1}};a.prototype.isOverPolygon=function(a){var b=f.camera,d=this.x+b.x,b=this.y+b.y;return a._rotation?(this._x=d,this._y=b,f.collisions.Polygon.haveCollided(a,this)):a.getBottom()<b||a.getTop()>b||a.getRight()<d||a.getLeft()>d?!1:!0};h=new a;f.setTouch(h)})(window.Match);(function(f){function e(){}e.prototype.rgb=function(b,d,a){return"rgb("+[b,d,a].join()+")"};e.prototype.rgba=function(b,d,a,e){return"rgba("+[b,d,a,e].join()+")"};e.prototype.rgbToHex=function(b,d,a){return"#"+this.componentToHex(b)+this.componentToHex(d)+this.componentToHex(a)};e.prototype.componentToHex=function(b){b=b.toString(16);return 1==b.length?"0"+b:b};e.prototype.hexToRgb=function(b){b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return this.rgb(parseInt(b[1],16),parseInt(b[2],16),
parseInt(b[3],16))};e.prototype.alpha=function(){return this.rgba(0,0,0,0)};e.prototype.random=function(){var b=window.Math;return this.rgb(b.round(255*b.random()),b.round(255*b.random()),b.round(255*b.random()))};e.prototype.rgbStringToObject=function(b){var d={};b&&(b=b.match(/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/))&&(d.r=parseInt(b[1]),d.g=parseInt(b[2]),d.b=parseInt(b[3]));return d};f.color=new e})(window.Match);(function(f){function e(){this.math=window.Math}e.prototype.integer=function(b,d){return this.math.floor(this.math.random()*(d-b+1))+b};e.prototype.decimal=function(b,d){return this.math.random()*(d-b)+b};e.prototype.bool=function(){return 0.5>this.math.random()};e.prototype.sign=function(){return this.bool()?1:-1};e.prototype.booleanFromChance=function(b){return this.integer(0,100)<=b};e.prototype.color=function(){return f.color.random()};f.random=new e})(window.Match);(function(f){function e(){}f.postProcess||(f.postProcess={});e.prototype.run=function(b){return b.canvas};f.postProcess.NoPostProcess=e})(window.M);(function(f){function e(){}f.postProcess||(f.postProcess={});e.prototype.run=function(b){var d=b.getImageData(0,0,b.canvas.width,b.canvas.height),a=d.data,e=a.length,g,f,n,p;for(g=0;g<e;g+=4)f=a[g],n=a[g+1],p=a[g+2],f=0.2126*f+0.7152*n+0.0722*p,a[g]=a[g+1]=a[g+2]=f;b.putImageData(d,0,0);return b.canvas};f.postProcess.GrayScale=e})(window.M);
(function(f){function e(b){if(void 0==b)throw Error("Brightness has no constructor that takes no arguments. You must specify the brightness value");this.value=b}f.postProcess||(f.postProcess={});e.prototype.run=function(b){for(var d=b.getImageData(0,0,b.canvas.width,b.canvas.height),a=d.data,e=0;e<a.length;e+=4)a[e]+=this.value,a[e+1]+=this.value,a[e+2]+=this.value;b.putImageData(d,0,0);return b.canvas};f.postProcess.Brightness=e})(window.M);
(function(f){function e(b,d){this.matrix=b;this.opaque=d}f.postProcess||(f.postProcess={});e.prototype.setSharpen=function(){this.matrix=[0,-1,0,-1,5,-1,0,-1,0]};e.prototype.setBlur=function(){this.matrix=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9]};e.prototype.setContour=function(){this.matrix=[1,1,1,1,0.7,-1,-1,-1,-1]};e.prototype.run=function(b){if(this.matrix){var d=Math.round(Math.sqrt(this.matrix.length)),a=Math.floor(d/2),e=b.getImageData(0,0,b.canvas.width,b.canvas.height),g=e.data,f=e.width,n=
e.height,p=document.createElement("canvas").getContext("2d");p.canvas.width=e.width;p.canvas.height=e.height;for(var e=p.getImageData(0,0,e.width,e.height),p=e.data,k=this.opaque?1:0,q=0;q<n;q++)for(var r=0;r<f;r++){for(var s=q,z=r,t=4*(q*f+r),D=0,E=0,F=0,A=0,B=0;B<d;B++)for(var C=0;C<d;C++){var v=s+B-a,w=z+C-a;0<=v&&(v<n&&0<=w&&w<f)&&(v=4*(v*f+w),w=this.matrix[B*d+C],D+=g[v]*w,E+=g[v+1]*w,F+=g[v+2]*w,A+=g[v+3]*w)}p[t]=D;p[t+1]=E;p[t+2]=F;p[t+3]=A+k*(255-A)}b.putImageData(e,0,0);return b.canvas}};
f.postProcess.Convolute=e})(window.M);(function(f){function e(){this.postProcessing=new f.postProcess.NoPostProcess;this.buffer=document.createElement("canvas").getContext("2d");this.onRenderList=[];this.needsRedraw=!0;this.needsSorting=!1;this.operation=this.scale=this.rotation=null;this.parrallaxFactor={x:1,y:1};this._onLoopAnimations=[];this.result=this.buffer.canvas;f.frontBuffer&&this.setSize(f.frontBuffer.canvas.width,f.frontBuffer.canvas.height)}e.prototype._loopThroughAnimations=function(){for(var b=0,d=this._onLoopAnimations.length;b<
d;b++)this._onLoopAnimations[b].onLoop()||this._onLoopAnimations.splice(b,1)};e.prototype.setAlpha=function(b){this._alpha=b};e.prototype.getAlpha=function(){return this._alpha};e.prototype.fadeIn=function(b,d){this._onLoopAnimations.push(new f.effects.visual.FadeIn(this,b,d));return this};e.prototype.fadeOut=function(b,d){this._onLoopAnimations.push(new f.effects.visual.FadeOut(this,b,d));return this};e.prototype.continousFade=function(b,d,a,e){this._onLoopAnimations.push(new f.effects.visual.ContinousFade(this,
b,d,a,e));return this};e.prototype.setBufferSize=function(b){if(!(b instanceof HTMLCanvasElement))throw Error("setBufferSize is expecting an HTMLCanvasElement as argument");this.buffer.canvas.width=b.width;this.buffer.canvas.height=b.height};e.prototype.setAntialiasing=function(b){this.buffer.mozImageSmoothingEnabled=b;this.buffer.webkitImageSmoothingEnabled=b;this.buffer.mozImageSmoothingEnabled=b;this.buffer.webkitImageSmoothingEnabled=b};e.prototype.getWidth=function(){return this.buffer.canvas.width};
e.prototype.getHeight=function(){return this.buffer.canvas.height};e.prototype.setWidth=function(b){this.buffer.canvas.width=b};e.prototype.setHeight=function(b){this.buffer.canvas.height=b};e.prototype.setSize=function(b,d){this.setWidth(b);this.setHeight(d)};e.prototype.getCenter=function(){return new f.math2d.Vector2d(this.buffer.canvas.width/2,this.buffer.canvas.height/2)};e.prototype.clearUsingDefault=function(b,d){b.clearRect(0,0,d.width,d.height)};e.prototype.clearUsingFillColor=function(b,
d){b.fillStyle=this.clearColor;b.fillRect(0,0,d.width,d.height)};e.prototype.clearUsingImage=function(b,d){b.drawImage(this.clearImage,0,0)};e.prototype.clear=e.prototype.clearUsingDefault;e.prototype.onLoop=function(b){if(this.needsRedraw){var d=b.camera.x*this.parrallaxFactor.x,a=b.camera.y*this.parrallaxFactor.y,e=d+b.camera.viewportWidth;b=a+b.camera.viewportHeight;var g=this.buffer,f=g.canvas;this.clear(g,f);this.renderGameObjects(this.onRenderList,g,f,d,a,e,b);this.needsRedraw=!1;this.result=
this.postProcessing.run(g)}this.needsSorting&&(this.sort(),this.needsSorting=!1);this._loopThroughAnimations();return this.result};e.prototype.renderGameObjects=function(b,d,a,e,g,f,n){for(var p in b){var k=b[p];k.isVisible(e,g,f,n)&&(k.onRender(d,a,e,g,f,n),k.children&&this.renderGameObjects(k.children,d,a,e,g,f,n))}};e.prototype.addToGame=function(){f.pushGameLayer(this)};e.prototype.renderizableChanged=function(){this.needsRedraw=!0};e.prototype.zIndexChanged=function(){this.needsSorting=!0};e.prototype.push=
function(b,d,a){if(!b)throw Error("Cannot push null Object to game layer");if(!b.onRender)throw Error(f.getObjectName(b)+" must implement onRender method");b.isVisible||(console.warn(f.getObjectName(b)+" does not implement isVisible method. A default method will be appended. Rendering objects outside of game area is inefficient and innecessary, please implement isVisible for better performance"),b.isVisible=function(){return!0});b.setZIndex||console.warn(f.getObjectName(b)+" does not implement setZIndex method");
b.getZIndex||console.warn(f.getObjectName(b)+" does not implement getZIndex method");b._zIndex||(b._zIndex=this.onRenderList.length);b.notifyChange||(console.warn(f.getObjectName(b)+" does not implement notifyChange method. This method must inform the onwerLayer of any change in a value that would require a redraw action. ie: function() { this.ownerLayer.renderizableChanged(); } ownerLayer is added when the object is pushed into a layer by default"),b.notifyChange=function(){this.ownerLayer&&this.ownerLayer.renderizableChanged()});
b.notifyZIndexChange||(console.warn(f.getObjectName(b)+" does not implement notifyZIndexChange method. This method must inform the onwerLayer of any change in the zIndex so that the layer reorders its children. ie: function() { this.ownerLayer.zIndexChanged(); } ownerLayer is added when the object is pushed into a layer by default"),b.notifyZIndexChange=function(){this.ownerLayer&&this.ownerLayer.zIndexChange()});b.ownerLayer=this;if(b.onLoad)b.onLoad();this.needsSorting=!0;this.onRenderList.push(b);
b.onLoop&&f.pushGameObject(b);d=f.camera;a=d.x*this.parrallaxFactor.x;var e=d.y*this.parrallaxFactor.y;this.needsRedraw=b.isVisible(a,e,a+d.viewportWidth,e+d.viewportHeight)};e.prototype.sort=function(){this.onRenderList.sort(this._sortFunction)};e.prototype._sortFunction=function(b,d){return b._zIndex-d._zIndex};e.prototype.getFirst=function(){return this.getIndex(0)};e.prototype.getIndex=function(b){try{return this.onRenderList[b]}catch(d){return null}};e.prototype.getAsBase64Image=function(){return this.buffer.canvas.toDataURL()};
e.prototype.getAsImage=function(){var b=new Image;b.src=this.getAsBase64Image();return b};e.prototype.get=function(b){if(this.cache&&this.cache.key==b)return this.cache;for(var d=this.onRenderList.length,a;d--;)if(a=this.onRenderList[d],b==a.key)return this.cache=a;return null};e.prototype.getLast=function(){return this.getIndex(this.onRenderList.length-1)};e.prototype.isOnRenderList=function(b){return-1!=this.onRenderList.indexOf(b)};e.prototype.remove=function(b){if(b){if("string"==typeof b)this.remove(this.get(b));
else{var d=this.onRenderList.indexOf(b);-1<d&&this.onRenderList.splice(d,1)}b.onLoop&&f.removeGameObject(b);b.ownerLayer=null;this.needsRedraw=!0}};e.prototype.removeAll=function(){this.onRenderList=[]};e.prototype.setBackground=function(b){""==!b&&"string"==typeof b?f.sprites[b]?(this.clearImage=f.sprites[b]._image,this.clear=this.clearUsingImage):(this.clearColor=b,this.clear=this.clearUsingFillColor):this.clear=this.clearUsingDefault};e.prototype.getBackground=function(){return this.buffer.canvas.getPropertyValue("background")};
f.GameLayer=f.Layer=e})(window.Match);(function(f,e){function b(){this.def="easeOutQuad";this.math=window.Math}function d(a,b,d,e,g){this.angle=0;this._rotationSpeed=0.1;this.speed=0.05;this.vanishRate=0.0050;this.alpha=1;this.setPath(a,b);this.setWidth(d);this.setHeight(e)}function a(a,b,d,e,g,f,h,m,n){this.minAngle||(this.minAngle=0);this.maxAngle||(this.maxAngle=6.28);this.amount=a;this.color=b;this.minWidth=d||1;this.minHeight=e||1;this.maxWidth=g||3;this.maxHeight=f||3;this.minSpeed=h||0.01;this.maxSpeed=m||0.1;this.vanishRate=n}
function h(a,b,g,f,h,m,n,k,p){this.origin=origin;this.direction=direction;a=particleAmount;var q=origin,r=direction;g=g||4;f=f||4;h=h||8;m=m||8;n=n||0.01;k=k||0.4;p=p||e.Math2d.randomFloat(0.01,0.03);for(var s=e.Math2d,t=[],z=0;z<a;z++){var u=new d(q,{x:q.x+5*r.x,y:q.y+5*r.y});u.setWidth(s.randomInt(g,h));u.setHeight(s.randomInt(f,m));if(b)u.color=b[s.randomInt(0,b.length-1)];else switch(s.randomInt(0,2)){case 0:u.color="rgb(255, 128, 0)";break;case 1:u.color="rgb(255, 180, 0)";break;case 2:u.color=
"rgb(255, 80, 0)"}p&&(u.vanishRate=p);u.speed=s.randomFloat(n,k);t.push(u)}this.particles=t;this.visibleParticles=this.particles.length}function g(a){this.operation="source-atop";this.startTime=0;e.applyProperties(this,a,["fillStyle"])}function m(a,b,d){void 0==b&&(b=1);this.rate=1/(b*e.getAverageFps());this.object=a;this.onFinished=d}function n(a,b,d){void 0==b&&(b=1);this.rate=1/(b*e.getAverageFps());this.object=a;this.onFinished=d}function p(a,b,d){void 0==b&&(b=1);this.seconds=b;this.object=a;
this.timer=0;this.onFinished=d}function k(a,b,d,g,f){void 0==b&&(b=1);this.rate=1/(b*e.getAverageFps());this.object=a;this.min=g||0;this.max=f||1;a.setAlpha(1);this.onFinished=this.changeFade;this.onLoop=d?this.fadeOut:this.fadeIn}function q(a,b,d,g,f){this.object=a;this._x=b;this._y=d;void 0==g&&(g=1);this.onFinished=f;f=e.Math2d;g*=e.getAverageFps();a=new f.Vector2d(a._x,a._y);b=new f.Vector2d(b,d);this.speed=f.getDistance(a,b)/g;this.direction=e.Math2d.getNormalized(e.Math2d.getVector2d(a,b))}
function r(a,b,d,g,f){g*=e.getAverageFps();a._scale||(a._scale={x:1,y:1});this.speedX=Math.abs(a._scale.x-b)/g;this.speedY=Math.abs(a._scale.y-d)/g;this.object=a;this._x=b;this._y=d;this.onFinished=f}function s(a,b,d,g,f){g*=e.getAverageFps();a._scale||(a._scale={x:1,y:1});this.speedX=Math.abs(a._scale.x-b)/g;this.speedY=Math.abs(a._scale.y-d)/g;this.object=a;this._x=b;this._y=d;this.onFinished=f}function z(a,b,d,e){this.object=a;this.times=void 0==b?6:2*b;this.duration=void 0==d?250:d;this.lastTime=
0;this.onFinished=e}function t(a,b,d,g){d||(d=1);this.frames=d*e.getAverageFps();a._rotation||(a._rotation=0);this.object=a;this.angle=b;this.onFinished=g;this._rotation=(this.angle-a._rotation)/this.frames}b.prototype.swing=function(a,b,d,e,g){return this[this.def](a,b,d,e,g)};b.prototype.easeInQuad=function(a,b,d,e,g){return e*(b/=g)*b+d};b.prototype.easeOutQuad=function(a,b,d,e,g){return-e*(b/=g)*(b-2)+d};b.prototype.easeInOutQuad=function(a,b,d,e,g){return 1>(b/=g/2)?e/2*b*b+d:-e/2*(--b*(b-2)-
1)+d};b.prototype.easeInCubic=function(a,b,d,e,g){return e*(b/=g)*b*b+d};b.prototype.easeOutCubic=function(a,b,d,e,g){return e*((b=b/g-1)*b*b+1)+d};b.prototype.easeInOutCubic=function(a,b,d,e,g){return 1>(b/=g/2)?e/2*b*b*b+d:e/2*((b-=2)*b*b+2)+d};b.prototype.easeInQuart=function(a,b,d,e,g){return e*(b/=g)*b*b*b+d};b.prototype.easeOutQuart=function(a,b,d,e,g){return-e*((b=b/g-1)*b*b*b-1)+d};b.prototype.easeInOutQuart=function(a,b,d,e,g){return 1>(b/=g/2)?e/2*b*b*b*b+d:-e/2*((b-=2)*b*b*b-2)+d};b.prototype.easeInQuint=
function(a,b,d,e,g){return e*(b/=g)*b*b*b*b+d};b.prototype.easeOutQuint=function(a,b,d,e,g){return e*((b=b/g-1)*b*b*b*b+1)+d};b.prototype.easeInOutQuint=function(a,b,d,e,g){return 1>(b/=g/2)?e/2*b*b*b*b*b+d:e/2*((b-=2)*b*b*b*b+2)+d};b.prototype.easeInSine=function(a,b,d,e,g){return-e*this.math.cos(b/g*(this.math.PI/2))+e+d};b.prototype.easeOutSine=function(a,b,d,e,g){return e*this.math.sin(b/g*(this.math.PI/2))+d};b.prototype.easeInOutSine=function(a,b,d,e,g){return-e/2*(this.math.cos(this.math.PI*
b/g)-1)+d};b.prototype.easeInExpo=function(a,b,d,e,g){return 0==b?d:e*this.math.pow(2,10*(b/g-1))+d};b.prototype.easeOutExpo=function(a,b,d,e,g){return b==g?d+e:e*(-this.math.pow(2,-10*b/g)+1)+d};b.prototype.easeInOutExpo=function(a,b,d,e,g){return 0==b?d:b==g?d+e:1>(b/=g/2)?e/2*this.math.pow(2,10*(b-1))+d:e/2*(-this.math.pow(2,-10*--b)+2)+d};b.prototype.easeInCirc=function(a,b,d,e,g){return-e*(this.math.sqrt(1-(b/=g)*b)-1)+d};b.prototype.easeOutCirc=function(a,b,d,e,g){return e*this.math.sqrt(1-
(b=b/g-1)*b)+d};b.prototype.easeInOutCirc=function(a,b,d,e,g){return 1>(b/=g/2)?-e/2*(this.math.sqrt(1-b*b)-1)+d:e/2*(this.math.sqrt(1-(b-=2)*b)+1)+d};b.prototype.easeInElastic=function(a,b,d,e,g){a=1.70158;var f=0,h=e;if(0==b)return d;if(1==(b/=g))return d+e;f||(f=0.3*g);h<this.math.abs(e)?(h=e,a=f/4):a=f/(2*this.math.PI)*this.math.asin(e/h);return-(h*this.math.pow(2,10*(b-=1))*this.math.sin((b*g-a)*2*this.math.PI/f))+d};b.prototype.easeOutElastic=function(a,b,d,e,g){a=1.70158;var f=0,h=e;if(0==
b)return d;if(1==(b/=g))return d+e;f||(f=0.3*g);h<this.math.abs(e)?(h=e,a=f/4):a=f/(2*this.math.PI)*this.math.asin(e/h);return h*this.math.pow(2,-10*b)*this.math.sin((b*g-a)*2*this.math.PI/f)+e+d};b.prototype.easeInOutElastic=function(a,b,d,e,g){a=1.70158;var f=0,h=e;if(0==b)return d;if(2==(b/=g/2))return d+e;f||(f=g*0.3*1.5);h<this.math.abs(e)?(h=e,a=f/4):a=f/(2*this.math.PI)*this.math.asin(e/h);return 1>b?-0.5*h*this.math.pow(2,10*(b-=1))*this.math.sin((b*g-a)*2*this.math.PI/f)+d:0.5*h*this.math.pow(2,
-10*(b-=1))*this.math.sin((b*g-a)*2*this.math.PI/f)+e+d};b.prototype.easeInBack=function(a,b,d,e,g,f){void 0==f&&(f=1.70158);return e*(b/=g)*b*((f+1)*b-f)+d};b.prototype.easeOutBack=function(a,b,d,e,g,f){void 0==f&&(f=1.70158);return e*((b=b/g-1)*b*((f+1)*b+f)+1)+d};b.prototype.easeInOutBack=function(a,b,d,e,g,f){void 0==f&&(f=1.70158);return 1>(b/=g/2)?e/2*b*b*(((f*=1.525)+1)*b-f)+d:e/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+d};b.prototype.easeInBounce=function(a,b,d,e,g){return e-this.easeOutBounce(a,
g-b,0,e,g)+d};b.prototype.easeOutBounce=function(a,b,d,e,g){return(b/=g)<1/2.75?e*7.5625*b*b+d:b<2/2.75?e*(7.5625*(b-=1.5/2.75)*b+0.75)+d:b<2.5/2.75?e*(7.5625*(b-=2.25/2.75)*b+0.9375)+d:e*(7.5625*(b-=2.625/2.75)*b+0.984375)+d};b.prototype.easeInOutBounce=function(a,b,d,e,g){return b<g/2?0.5*this.easeInBounce(a,2*b,0,e,g)+d:0.5*this.easeOutBounce(a,2*b-g,0,e,g)+0.5*e+d};d.prototype.setWidth=function(a){this._halfWidth=a/2};d.prototype.setHeight=function(a){this._halfHeight=a/2};d.prototype.setPath=
function(a,b){this._x=a.x;this._y=a.y;this.direction=e.math2d.getVector2d(a,b)};d.prototype.onLoop=function(){this.alpha-=this.vanishRate;this.angle+=this._rotationSpeed;this._x+=this.speed*this.direction.x;this._y+=this.speed*this.direction.y;this.notifyChange()};d.prototype.onRender=function(a,b,d,e){0<=this.alpha&&(a.save(),a.globalAlpha=this.alpha,a.translate(this._x-d,this._y-e),a.rotate(this.angle),a.fillStyle=this.fillStyle,a.fillRect(-this._halfWidth,-this._halfHeight,this._halfWidth,this._halfHeight),
a.restore())};d.prototype.setZIndex=function(a){this._zIndex=a;this.notifyChange();this.notifyZIndexChange()};d.prototype.isVisible=function(a,b,d,e){return 0>=this.alpha||this._y+this._halfHeight<b||this._y-this._halfHeight>e||this._x+this._halfWidth<a||this._x-this._halfWidth>d?!1:!0};a.prototype.onLoop=function(){if(this.children){for(var a=0,b=this.children.length,d=0,e;a<b;a++)if(e=this.children[a],0>=e.alpha)d++;else e.onLoop();d==b?this.children=null:this.notifyChange()}};a.prototype.onRender=
function(){};a.prototype.isVisible=function(){return!0};a.prototype.setZIndex=function(a){this._zIndex=a;this.notifyChange();this.notifyZIndexChange()};a.prototype.create=function(a,b){var g=e.random;this.children=[];for(var f=0;f<this.amount;f++){var h=g.decimal(this.minAngle,this.maxAngle),m={},n={};m.x=a;m.y=b;n.x=a+50*Math.cos(h);n.y=b+50*Math.sin(h);h=new d(m,n);h.setWidth(g.integer(this.minWidth,this.maxWidth));h.setHeight(g.integer(this.minHeight,this.maxHeight));if(this.color)h.fillStyle=
this.color[g.integer(0,color.length-1)];else switch(g.integer(0,2)){case 0:h.fillStyle="rgb(255, 128, 0)";break;case 1:h.fillStyle="rgb(255, 180, 0)";break;default:h.fillStyle="rgb(255, 80, 0)"}this.vanishRate&&(h.vanishRate=this.vanishRate);h.speed=g.decimal(this.minSpeed,this.maxSpeed);this.children.push(h)}};h.prototype.create=function(a,b){};h.prototype.onLoop=function(a){if(this.visible){for(var b,d=0;d<this.particles.length;d++)b=this.particles[d],b.onLoop(a),b.isVisible()||(this.loop?(b.setPath(this.origin,
{x:this.origin.x+5*this.direction.x,y:this.origin.y+5*this.direction.y}),b.rotation=0,b.alpha=1,b.angle=0,b.vanishRate=e.Math2d.randomFloat(0.05,0.2),b.speed=e.Math2d.randomFloat(0.0050,0.5)):this.visibleParticles--);1>this.visibleParticles&&e.remove(this)}};g.prototype.render=function(a,b,d){this.isVisible()&&(a.globalCompositeOperation=this.operation,a.fillStyle=this.fillStyle,a.fillRect(0,0,b,d))};g.prototype.show=function(){this.startTime=e.getTimeInMillis()};g.prototype.isVisible=function(){return this.showAlways||
e.getTimeInMillis()-this.startTime<this.duration};m.prototype.initialize=function(){this.object.setAlpha(0);this.onLoop=this.run;return!0};m.prototype.run=function(){var a=this.object.getAlpha()+this.rate;if(1>a)this.object.setAlpha(a);else return this.object.setAlpha(1),this.onFinished&&this.onFinished.apply(this.object),!1;return!0};m.prototype.onLoop=m.prototype.initialize;n.prototype.initialize=function(){this.object.setAlpha(1);this.onLoop=this.run;return!0};n.prototype.run=function(){var a=
this.object.getAlpha()-this.rate;if(0<a)this.object.setAlpha(a);else return this.object.setAlpha(0),this.onFinished&&this.onFinished.apply(this.object),!1;return!0};n.prototype.onLoop=n.prototype.initialize;p.prototype.initialize=function(a){this.timer=new e.TimeCounter(1E3*this.seconds);this.onLoop=this.run};p.prototype.run=function(){return this.timer.elapsed()?(this.onFinished&&this.onFinished.apply(this.object),!1):!0};p.prototype.onLoop=p.prototype.initialize;k.prototype.fadeIn=function(a){a=
this.object._alpha+this.rate;a<this.max?this.object.setAlpha(a):(this.object.setAlpha(this.max),this.onLoop=this.fadeOut);return!0};k.prototype.fadeOut=function(){var a=this.object._alpha-this.rate;a>this.min?this.object.setAlpha(a):(this.object.setAlpha(this.min),this.onLoop=this.fadeIn);return!0};q.prototype.onLoop=function(a){a=Math.abs(this._x-this.object._x)>this.speed;var b=Math.abs(this._y-this.object._y)>this.speed;a&&this.object.offsetX(this.direction.x*this.speed);b&&this.object.offsetY(this.direction.y*
this.speed);return a||b?!0:(this.object.setLocation(this._x,this._y),this.onFinished&&this.onFinished.apply(this.object),!1)};r.prototype.onLoop=function(a){this.object._scale.x<this._x&&(this.object._scale.x+=this.speedX,this.notifyChange());this.object._scale.y<this._y&&(this.object._scale.y+=this.speedY,this.notifyChange());return this.object._scale.x>=this._x&&this.object._scale.y>=this._y?(this.onFinished&&this.onFinished.apply(this.object),!1):!0};s.prototype.onLoop=function(a){this.object._scale.x>
this._x&&(this.object._scale.x-=this.speedX,this.notifyChange());this.object._scale.y>this._y&&(this.object._scale.y-=this.speedY,this.notifyChange());return this.object._scale.x<=this._x&&this.object._scale.y<=this._y?(this.onFinished&&this.onFinished.apply(this.object),!1):!0};z.prototype.onLoop=function(a){if(e.getTimeInMillis()-this.lastTime>=this.duration){if(this.times--)1==this.object._alpha?this.object.setAlpha(0):this.object.setAlpha(1);else return this.object.setAlpha(void 0),this.onFinished&&
this.onFinished.apply(this.object),!1;this.lastTime=e.getTimeInMillis()}return!0};t.prototype.onLoop=function(a){if(this.frames--)this.object.offsetRotation(this._rotation);else return this.onFinished&&this.onFinished.apply(this.object),!1;return!0};f.visual={Particle:d,LinearParticleEmitter:h,RadialParticleEmitter:a,Tint:g,Move:q,FadeIn:m,FadeOut:n,ContinousFade:k,ScaleUp:r,ScaleDown:s,Rotate:t,Twinkle:z,Wait:p}})(M.effects||(M.effects={}),M);(function(f){function e(b,d,a){this.interval=b;this._lastTime=f.getTime();a?(this.owner=a,this.callback=d):this.tick=d;this.enabled=!0}e.prototype.onLoop=function(b){this.enabled&&f.elapsedTimeFrom(this._lastTime,this.interval)&&(this.tick(),this._lastTime=f.getTime())};e.prototype.tick=function(){this.callback.call(this.owner)};f.Timer=e})(window.Match);(function(f){function e(b){this._lastTime=0;this.time=b}e.prototype.initialize=function(){this._lastTime=f.getTime();this.elapsed=this.run;return!1};e.prototype.run=function(){var b=f.getTime();return b-this.time>=this._lastTime?(this._lastTime=b,!0):!1};e.prototype.elapsed=e.prototype.initialize;f.TimeCounter=e})(window.Match);(function(f,e){function b(){this.path="";this.total=this.toLoad=0;this.onImageLoaded=new e;this.onAllImagesLoaded=new e;this.onImageError=new e}function d(){f.sprites._imageError(this)}function a(){f.sprites._imageLoaded(this)}b.prototype._imageLoaded=function(a){this.toLoad--;if(a.frames)if(a.frames instanceof Array)for(var b in a.frames)a.frames[b].halfWidth=a.frames[b].width/2,a.frames[b].halfHeight=a.frames[b].height/2;else{b=[];var d=a.frames.width,e=a.frames.height,f=a.frames.padding||0,k=Math.floor(a.width/
(d+f)),q=Math.floor(a.height/(e+f)),r,s;for(s=0;s<q;s++)for(r=0;r<k;r++)b.push({x:(f+d)*r+f,y:(f+e)*s+f,width:d,height:e,halfWidth:d/2,halfHeight:e/2});a.frames=b}else a.frames=[{x:0,y:0,width:a.width,height:a.height,halfWidth:a.width/2,halfHeight:a.height/2}];this.onImageLoaded.raise({image:a,name:a.getAttribute("data-name"),remaining:this.toLoad,total:this.total});0>=this.toLoad&&this.onAllImagesLoaded.raise()};b.prototype._imageError=function(a){this.toLoad--;this.onImageError.raise(a);console.error("Could not load",
a.src)};b.prototype.load=function(b){var e,f,n;b.onProgress&&(this.onImageLoaded.addEventListener(b.onProgress),b.onProgress=null);b.onFinish&&(this.onAllImagesLoaded.addEventListener(b.onFinish),b.onFinish=null);for(n in b)e=b[n],f=new Image,f.setAttribute("data-name",n),f.onload=a,f.onerror=d,this.total=++this.toLoad,"string"==typeof e?f.src=this.path+e:(f.src=this.path+e.source,f.frames=e.frames,f.animations=e.animations),this[n]=f};b.prototype.remove=function(a){this[a]instanceof Image&&(delete this[a],
0<=this.total-1&&this.total--,0<=this.toLoad-1&&this.toLoad--)};b.prototype.removeAll=function(){for(var a in this)this.remove(a)};b.prototype.removeAllEventListeners=function(){this.onImageLoaded=new e;this.onAllImagesLoaded=new e;this.onImageError=new e};f.SpriteManager=new b;f.sprites=f.SpriteManager})(M||(M={}),M.EventListener||(M.EventListener={}));(function(f){function e(){f.sounds[this.name].setReady();f.sounds.toLoad--;0>=f.sounds.toLoad&&f.sounds.onAllSoundsLoaded.raise()}function b(){console.warn("Unable to load "+this.src);f.sounds.error=!0;f.sounds[this.name].setNotReady();f.sounds.toLoad--;0>=f.sounds.toLoad&&f.sounds.onAllSoundsLoaded.raise()}function d(a,b){this.audioBuffer=[];this.src=b;this.name=a;this.increaseBuffer()}function a(){this.total=this.toLoad=0;this.onSoundLoaded=new f.EventListener;this.onAllSoundsLoaded=new f.EventListener;
this.onSoundError=new f.EventListener;this.error=!1}d.prototype.MAX_BUFFER=3;d.prototype.setReady=function(){this.canPlay=this.checkOk;1==this.audioBuffer.length&&f.sounds.onSoundLoaded.raise({sound:this,remaining:f.sounds.toLoad,total:f.sounds.total})};d.prototype.setNotReady=function(){this.canPlay=this.checkOk;f.sounds.onSoundError.raise({sound:this,remaining:f.sounds.toLoad,total:f.sounds.total})};d.prototype.play=function(){if(this.canPlay()){for(var a=0,b;a<this.audioBuffer.length;){b=this.audioBuffer[a];
if(b.ended||0==b.currentTime){b.play();return}a++}b=this.audioBuffer[0];b.pause();b.currentTime=0;b.play();this.audioBuffer.length<this.MAX_BUFFER&&this.increaseBuffer()}};d.prototype.stop=function(){this.canPlay()&&this.each(function(a){0<a.duration&&(a.pause(),a.currentTime=0)})};d.prototype.pause=function(){this.canPlay()&&(this.onNextPauseResume?(this.play(),this.onNextPauseResume=!1):(this.onNextPauseResume=this.isPlaying(),this.each(function(a){a.pause()})))};d.prototype.checkFail=function(){return!1};
d.prototype.checkOk=function(){return!0};d.prototype.canPlay=function(){this.increaseBuffer();return!1};d.prototype.setPlaybackRate=function(a){this.each(function(b){b.playbackRate=a})};d.prototype.resetPlaybackRate=function(){this.each(function(a){a.playbackRate=1})};d.prototype.getPlaybackRate=function(){return this.audioBuffer[0].playbackRate};d.prototype.isPaused=function(){var a=0;for(l=this.audioBuffer.length;a<l;a++)if(this.audioBuffer[a].paused)return!0;return!1};d.prototype.setVolume=function(a){this.each(function(b){b.volume=
a})};d.prototype.isPlaying=function(){var a=0;for(l=this.audioBuffer.length;a<l;a++)if(!this.audioBuffer[a].paused)return!0;return!1};d.prototype.each=function(a){for(var b=this.audioBuffer.length;b--;)a(this.audioBuffer[b])};d.prototype.increaseBuffer=function(){var a=new Audio(this.src),d=this.audioBuffer[0];a.addEventListener("loadeddata",e);a.addEventListener("error",b);a.name=this.name;d&&(a.muted=d.muted,a.volume=d.volume);this.audioBuffer.push(a)};d.prototype.mute=function(){this.each(function(a){a.muted=
!a.muted})};d.prototype.setLoop=function(a){this.audioBuffer[0].loop=a};var h=function(){};fakeSound={name:""};for(var g in d.prototype)"function"==typeof d.prototype[g]&&(fakeSound[g]=h);a.prototype.load=function(){if(1<arguments.length)this.loadOne(arguments[0],arguments[1]);else{var a=arguments[0];a.onProgress&&(this.onSoundLoaded.addEventListener(a.onProgress),a.onProgress=null);a.onFinish&&(this.onAllSoundsLoaded.addEventListener(a.onFinish),a.onFinish=null);for(var b in a)this.loadOne(b,a[b])}};
a.prototype.loadOne=function(a,b){this.total=++this.toLoad;void 0==f.browser.supportedAudioFormat?(this[a]=fakeSound,fakeSound.name=a,this.onSoundLoaded.raise({sound:fakeSound,remaining:f.sounds.toLoad--,total:f.sounds.total}),0>=this.toLoad&&this.onAllSoundsLoaded.raise()):("."!=b.charAt(b.length-4)&&(b+=f.browser.supportedAudioFormat),this[a]=new d(a,b));this[a].name=a};a.prototype.pause=function(){for(var a in this)this[a]instanceof d&&this[a].pause()};a.prototype.setVolume=function(a){for(var b in this)this[b]instanceof
d&&this[b].setVolume(a)};a.prototype.mute=function(){for(var a in this)this[a]instanceof d&&this[a].mute()};a.prototype.stop=function(){for(var a in this)this[a]instanceof d&&this[a].stop()};a.prototype.removeAll=function(){for(var a in this)delete this[a];this.audioBuffer=[];this.src=url;this.name=name;this.increaseBuffer()};f.SoundManager=f.sounds=new a})(window.Match);(function(f,e){function b(a){this._halfHeight=this._halfWidth=this._height=this._width=this._y=this._x=0;this._scale=this._rotation=null;this._visible=!0;this.operation=null;this._onLoopAnimations=[];this._chainAnimations=[];this._onLoopTimers=[];this._alpha=null;this.set(a)}function d(a,b,d,e){this.width=d-a;this.height=e-b;this._x=a+this.width/2;this._y=b+this.height/2}b.prototype.notifyChange=function(){this.ownerLayer&&this.ownerLayer.renderizableChanged()};b.prototype.notifyZIndexChange=function(){this.ownerLayer&&
this.ownerLayer.zIndexChanged()};b.prototype.removeChild=function(a){this.children[a]=null};b.prototype.putChild=function(a,b){this.children||(this.children={});b.ownerLayer=this.ownerLayer;this.children[a]=b};b.prototype._zIndex=0;b.prototype.onLoop=function(a){this._loopThroughAnimations();this._loopThroughTimers();this.prevX=this._x;this.prevY=this._y;if(this.onUpdate)this.onUpdate(a)};b.prototype.set=function(a){if(a){var b="",d;for(d in a)if(b="set"+d.charAt(0).toUpperCase()+d.substr(1),this[b])this[b](a[d]);
else this[d]=a[d]}};b.prototype.setAlpha=function(a){0<=a&&1>=a?(this._alpha=a,this.notifyChange()):this._alpha=null};b.prototype.getAlpha=function(){return this._alpha};b.prototype._loopThroughAnimations=function(){for(var a=0,b=this._onLoopAnimations.length;a<b;a++)this._onLoopAnimations[a].onLoop()||this._onLoopAnimations.splice(a,1);this._chainAnimations.length&&(this._chainAnimations[0].onLoop()||this._chainAnimations.splice(0,1))};b.prototype.clearAnimations=function(){this._onLoopAnimations=
[]};b.prototype.fadeIn=function(a,b){this._onLoopAnimations.push(new e.FadeIn(this,a,b));return this};b.prototype.fadeOut=function(a,b){this._onLoopAnimations.push(new e.FadeOut(this,a,b));return this};b.prototype.continousFade=function(a,b,d,f){this._onLoopAnimations.push(new e.ContinousFade(this,a,b,d,f));return this};b.prototype.move=function(a,b,d,f){this._onLoopAnimations.push(new e.Move(this,a,b,d,f));return this};b.prototype.scaleUp=function(a,b,d,f){this._onLoopAnimations.push(new e.ScaleUp(this,
a,b,d,f));return this};b.prototype.scaleDown=function(a,b,d,f){this._onLoopAnimations.push(new e.ScaleDown(this,a,b,d,f));return this};b.prototype.twinkle=function(a,b,d){this._onLoopAnimations.push(new e.Twinkle(this,a,b,d));return this};b.prototype.rotate=function(a,b,d){this._onLoopAnimations.push(new e.Rotate(this,a,b,d));return this};b.prototype.chainWait=function(a,b){this._chainAnimations.push(new e.Wait(this,a,b));return this};b.prototype.chainFadeIn=function(a,b){this._chainAnimations.push(new e.FadeIn(this,
a,b));return this};b.prototype.chainFadeOut=function(a,b){this._chainAnimations.push(new e.FadeOut(this,a,b));return this};b.prototype.chainContinousFade=function(a,b,d,f){this._chainAnimations.push(new e.ContinousFade(this,a,b,d,f));return this};b.prototype.chainMove=function(a,b,d,f){this._chainAnimations.push(new e.Move(this,a,b,d,f));return this};b.prototype.chainScaleUp=function(a,b,d,f){this._chainAnimations.push(new e.ScaleUp(this,a,b,d,f));return this};b.prototype.chainScaleDown=function(a,
b,d,f){this._chainAnimations.push(new e.ScaleDown(this,a,b,d,f));return this};b.prototype.chainTwinkle=function(a,b,d){this._chainAnimations.push(new e.Twinkle(this,a,b,d));return this};b.prototype.chainRotate=function(a,b,d){this._chainAnimations.push(new e.Rotate(this,a,b,d));return this};b.prototype._loopThroughTimers=function(){for(var a=0,b=this._onLoopTimers.length;a<b;a++)this._onLoopTimers[a].onLoop()};b.prototype.addTimer=function(a,b){var d=new f.Timer(a,b,this);this._onLoopTimers.push(d);
return d};b.prototype.removeTimer=function(a){this._onLoopTimers.splice(this._onLoopTimers.indexOf(this._getTimer(a)),1);return this};b.prototype._getTimer=function(a){for(var b=0,d=this._onLoopTimers.length;b<d;b++)if(this._onLoopTimers[b].callback==a)return this._onLoopTimers[b]};b.prototype.setZIndex=function(a){this._zIndex=a;this.notifyChange();this.notifyZIndexChange()};b.prototype.getZIndex=function(){return this._zIndex};b.prototype.setVisible=function(a){this._visible=a;this.notifyChange()};
b.prototype.setWidth=function(a){this._width=a;this._halfWidth=a/2;this.notifyChange()};b.prototype.setHeight=function(a){this._height=a;this._halfHeight=a/2;this.notifyChange()};b.prototype.getWidth=function(){return this._scale?this._width*this._scale.x:this._width};b.prototype.getHeight=function(){return this._scale?this._height*this._scale.y:this._height};b.prototype.setSize=function(a,b){this.setWidth(a);this.setHeight(b)};b.prototype.getSize=function(){return{width:this.getWidth(),height:this.getHeight()}};
b.prototype.setScale=function(a,b){if(a||b)a||(a=1),b||(b=1),this._scale={x:a,y:b},this.notifyChange()};b.prototype.setScaleX=function(a){this._scale||(this._scale={},this._scale.y=1);this._scale.x=a;this.notifyChange()};b.prototype.setScaleY=function(a){this._scale||(this._scale={},this._scale.x=1);this._scale.y=a;this.notifyChange()};b.prototype.mirror=function(){this.invertX()};b.prototype.invertX=function(){this._scale||(this._scale={},this._scale.x=1,this._scale.y=1);this._scale.x*=-1;this.notifyChange()};
b.prototype.invertY=function(){this._scale||(this._scale={},this._scale.x=1,this._scale.y=1);this._scale.y=-1;this.notifyChange()};b.prototype.getLeft=function(){return this._scale?void 0!=this.pivotX?this._x+this.pivotX-this._width*this._scale.x:this._x-this._halfWidth*this._scale.x:void 0!=this.pivotX?this._x+this.pivotX-this._width:this._x-this._halfWidth};b.prototype.getRight=function(){return this._scale?void 0!=this.pivotX?this._x+this.pivotX+this._width*this._scale.x:this._x+this._halfWidth*
this._scale.x:void 0!=this.pivotX?this._x+this.pivotX+this._width:this._x+this._halfWidth};b.prototype.getTop=function(){return this._scale?void 0!=this.pivotY?this._y+this.pivotY-this._height*this._scale.y:this._y-this._halfHeight*this._scale.y:void 0!=this.pivotY?this._y+this.pivotY-this._height:this._y-this._halfHeight};b.prototype.getBottom=function(){return this._scale?void 0!=this.pivotY?this._y+this.pivotY+this._height*this._scale.y:this._y+this._halfHeight*this._scale.y:void 0!=this.pivotY?
this._y+this.pivotY+this._height:this._y+this._halfHeight};b.prototype.setLeft=function(a){this._x=this._scale?a+this._halfWidth*this._scale.x:a+this._halfWidth;this.notifyChange()};b.prototype.setRight=function(a){this._x=this._scale?a-this._halfWidth*this._scale.x:a-this._halfWidth;this.notifyChange()};b.prototype.setTop=function(a){this._y=this._scale?a+this._halfHeight*this._scale.y:a+this._halfHeight;this.notifyChange()};b.prototype.setBottom=function(a){this._y=this._scale?a-this._halfHeight*
this._scale.y:a-this._halfHeight;this.notifyChange()};b.prototype.getLocation=function(){return{x:this._x,y:this._y}};b.prototype.setLocation=function(a,b){this.prevX=this._x;this.prevY=this._y;this._x=a;this._y=b;this.notifyChange()};b.prototype.movedInX=function(){return this.prevX!=this._x};b.prototype.movedInY=function(){return this.prevY!=this._y};b.prototype._applyOperation=function(a){this.operation?(a.globalCompositeOperation=this.operation,a.operationChanged=!1):a.operationChanged&&a.resetOperation()};
b.prototype._applyAlpha=function(a){null!=this._alpha&&0<=this._alpha&&1>=this._alpha?(a.globalAlpha=this._alpha,a.alphaChanged=!1):a.alphaChanged&&a.resetAlpha()};b.prototype._applyShadow=function(a){this._shadow?(a.shadowOffsetX=x,a.shadowOffsetY=y,a.shadowColor=color,a.shadowBlur=blur,a.shadowChanged=!1):a.shadowChanged&&a.resetShadow()};b.prototype._applyTranslation=function(a,b,d){a.translate(this._x-b,this._y-d)};b.prototype._applyRotation=function(a){this._rotation&&a.rotate(this._rotation)};
b.prototype._applyScale=function(a){this._scale&&a.scale(this._scale.x,this._scale.y)};b.prototype.offsetAlpha=function(a){this._alpha+=a;this.notifyChange()};b.prototype.offsetRotation=function(a){this._rotation+=a;this.notifyChange()};b.prototype.isVisible=function(a,b,d,e){return 0!=this._alpha&&this._visible?this.isIn(a,b,d,e):!1};b.prototype.isIn=function(a,b,e,m){return this._rotation?f.collisions.Polygon.haveCollided(this,new d(a,b,e,m)):this.getBottom()<b||this.getTop()>m||this.getRight()<
a||this.getLeft()>e?!1:!0};b.prototype.setRotation=function(a){this._rotation=a;this.notifyChange()};b.prototype.getRotation=function(){return this._rotation};b.prototype.setX=function(a){this.prevX=this._x;this._x=a;this.notifyChange()};b.prototype.setY=function(a){this.prevY=this._y;this._y=a;this.notifyChange()};b.prototype.offset=function(a,b){this.prevX=this._x;this.prevY=this._y;this._x+=a;this._y+=b;this.notifyChange()};b.prototype.offsetX=function(a){this.prevX=this._x;this._x+=a;this.notifyChange()};
b.prototype.offsetY=function(a){this.prevY=this._y;this._y+=a;this.notifyChange()};b.prototype.centerAt=function(a){this.setLocation(a.x,a.y)};b.prototype.getX=function(){return this._x};b.prototype.getY=function(){return this._y};b.prototype.onRender=function(){throw Error("Method onRender must be overriden");};b.prototype.getMaxSize=function(){return Math.max(this.getWidth(),this.getHeight())};f.renderers=f.renderers||{};f.renderers.Renderizable=b;d.prototype.getWidth=function(){return this.width};
d.prototype.getHeight=function(){return this.height}})(window.M,window.M.effects.visual);(function(f,e,b){function d(a){b.apply(this);a&&this.setImage(a)}d.prototype.setImage=function(a,b){if(!a)throw Error("Image cannot be null");if(a instanceof Image)a.frames||(a.frames=[{x:0,y:0,width:a.width,height:a.height,halfWidth:a.width/2,halfHeight:a.height/2}]),this._image=a;else if(e.sprites[a])this._image=e.sprites[a];else throw Error("Image by id "+a+" not loaded");this.setFrameIndex(b)};d.prototype.play=function(a,b){if(!this._animation||this.animationName!=a||!this.isPlaying){if(a||!this._animation){if(!this._image)throw Error("No image selected");
if(!this._image.animations)throw Error("Image has no animations");if(!this._image.animations[a])throw Error("Image has no animation by name "+a);this._animation=this._image.animations[a];this.animationName=a;this._frameIndex=0}this.isPlaying=!0;this.loop=b;this.notifyChange()}};d.prototype.stop=function(){this.isPlaying=!1};d.prototype._animate=function(){if(this.isPlaying){var a=e.getTime();this.currentFrameStartInMillis||(this.currentFrameStartInMillis=a);a-this.currentFrameStartInMillis>this._animation.duration&&
(this.currentFrame=this._image.frames[this._animation.frames[this._frameIndex]],this._frameIndex<this._animation.frames.length-1?this._frameIndex++:this.loop?this._frameIndex=0==this._frameIndex?1:0:this.isPlaying=!1,this.currentFrameStartInMillis=a,this.notifyChange())}};d.prototype.isLastAnimationFrame=function(){return this._animation?this._frameIndex==this._animation.frames.length-1:!1};d.prototype.isFirstAnimationFrame=function(){return this._animation?1==this._frameIndex:!1};d.prototype.onLoop=
function(a){this._loopThroughAnimations();this._loopThroughTimers();if(this.onUpdate)this.onUpdate(a);this._animate()};d.prototype.onRender=function(a,b,d,e){if(this._image){this._applyOperation(a);this._applyAlpha(a);var f;b=this.pivotX?this.pivotX:-this.oHW||-this.currentFrame.halfWidth;f=this.pivotY?this.pivotY:-this.oHH||-this.currentFrame.halfHeight;this._rotation||this._scale?(a.save(),this._applyTranslation(a,d,e),this._applyRotation(a),this._applyScale(a),a.drawImage(this._image,this.currentFrame.x,
this.currentFrame.y,this.currentFrame.width,this.currentFrame.height,b,f,this.oW||this.currentFrame.width,this.oH||this.currentFrame.height),a.restore()):a.drawImage(this._image,this.currentFrame.x,this.currentFrame.y,this.currentFrame.width,this.currentFrame.height,this._x+b,this._y+f,this.oW||this.currentFrame.width,this.oH||this.currentFrame.height);this._applyShadow(a)}};d.prototype.setSize=function(a,b){this.oW=a;this.oH=b;this.oHW=a/2;this.oHH=b/2;this.notifyChange()};d.prototype.setFrameIndex=
function(a){this._frameIndex=a=a||0;this.currentFrame=this._image.frames[a]};d.prototype.getTop=function(){return this._scale?this._y-this.currentFrame.halfHeight*this._scale.y:this._y-this.currentFrame.halfHeight};d.prototype.getBottom=function(){return this._scale?this._y+this.currentFrame.halfHeight*this._scale.y:this._y+this.currentFrame.halfHeight};d.prototype.getLeft=function(){return this._scale?this._x-this.currentFrame.halfWidth*this._scale.x:this._x-this.currentFrame.halfWidth};d.prototype.getRight=
function(){return this._scale?this._x+this.currentFrame.halfWidth*this._scale.x:this._x+this.currentFrame.halfWidth};d.prototype.getWidth=function(){return this._scale?this.currentFrame.width*this._scale.x:this.currentFrame.width};d.prototype.getHeight=function(){return this._scale?this.currentFrame.height*this._scale.y:this.currentFrame.height};d.prototype.setLeft=function(a){this._x=this._scale?a+this.currentFrame.halfWidth*this._scale.x:a+this.currentFrame.halfWidth;this.notifyChange()};d.prototype.setRight=
function(a){this._x=this._scale?a-this.currentFrame.halfWidth*this._scale.x:a-this.currentFrame.halfWidth;this.notifyChange()};d.prototype.setTop=function(a){this._y=this._scale?a+this.currentFrame.halfHeight*this._scale.y:a+this.currentFrame.halfHeight;this.notifyChange()};d.prototype.setBottom=function(a){this._y=this._scale?a-this.currentFrame.halfHeight*this._scale.y:a-this.currentFrame.halfHeight;this.notifyChange()};e.extend(d,b);f.Sprite=d})(window.Match.renderers,window.Match,window.Match.renderers.Renderizable);(function(f,e,b){function d(a){b.apply(this,arguments);this._fillStyle="black";this._lineWidth=this._strokeStyle=null;this.set(a)}d.prototype.css=function(a){a=e.getStyleBySelector(a);""!=a.color&&this.setFillStyle(a.color);""!=a.backgroundColor&&this.setFillStyle(a.backgroundColor);""!=a.borderColor&&this.setStrokeStyle(a.borderColor);""!=a.borderWidth&&this.setLineWidth(a.borderWidth);""!=a.width&&this.setWidth(a.width);""!=a.height&&this.setHeight(a.height);""!=a.left&&this.setLeft(a.left);""!=
a.right&&this.setRight(a.right);""!=a.top&&this.setTop(a.top);""!=a.bottom&&this.setBottom(a.bottom);if(""!=a.boxShadow){var b,d,f,n;-1<a.boxShadow.indexOf("rgb")?b=a.boxShadow.match(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/)[0]:a.boxShadow.indexOf("px")>a.boxShadow.indexOf(" ")&&(b=a.boxShadow.substr(0,a.boxShadow.indexOf(" ")));if(a=a.boxShadow.match(/([0-9]+px) ([0-9]+px) ([0-9]+px)/))d=parseInt(a[1]),f=parseInt(a[2]),n=parseInt(a[3]);this.setShadow(d,f,b,n)}};d.prototype.setFillStyle=function(a){this._fillStyle=
a;this._changed=!0};d.prototype.setStrokeStyle=function(a){this._strokeStyle=a;this._changed=!0};d.prototype.setStrokeWidth=function(a){this._lineWidth=a;this._changed=!0};d.prototype.setShadow=function(a,b,d,e){this._shadow={x:a,y:b,color:d||"black",blur:e||1};this._changed=!0};d.prototype.getFillStyle=function(){return this._fillStyle};d.prototype.getStrokeStyle=function(){return this._strokeStyle};d.prototype.getStrokeWidth=function(){return this._lineWidth};d.prototype.getShadow=function(){return this._shadow};
d.prototype.onRender=function(a,b,d,e){this._applyOperation(a);this._applyAlpha(a);this._rotation||this._scale?(a.save(),this._applyTranslation(a,d,e),this._applyRotation(a),this._applyScale(a),this._fillStyle&&(a.fillStyle=this._fillStyle),a.fillRect(-this._halfWidth,-this._halfHeight,this._width,this._height),this._lineWidth&&(a.lineWidth=this._lineWidth),this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.strokeRect(-this._halfWidth,-this._halfHeight,this._width,this._height)),a.restore()):(this._fillStyle&&
(a.fillStyle=this._fillStyle),a.fillRect(this._x-this._halfWidth,this._y-this._halfHeight,this._width,this._height),this._lineWidth&&(a.lineWidth=this._lineWidth),this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.strokeRect(this._x-this._halfWidth,this._y-this._halfHeight,this._width,this._height)));this._applyShadow(a)};e.extend(d,b);f.Rectangle=d})(window.Match.renderers,window.Match,window.Match.renderers.Renderizable);(function(f,e,b){function d(a){b.apply(this,arguments);this.changed=!0;this._fillStyle="rgb(0,0,0)";this._lineWidth=this._strokeStyle=null;this._radius=1;this._startAngle=0;this._endAngle=6.28;this.set(a)}d.prototype.css=function(a){a=e.getStyleBySelector(a);""!=a.color&&this.setFillStyle(a.color);""!=a.backgroundColor&&this.setFillStyle(a.backgroundColor);""!=a.borderColor&&this.setStrokeStyle(a.borderColor);""!=a.borderWidth&&this.setLineWidth(a.borderWidth);""!=a.width&&this.setRadius(a.width);
""!=a.height&&this.setRadius(a.height);""!=a.left&&this.setLeft(a.left);""!=a.right&&this.setRight(a.right);""!=a.top&&this.setTop(a.top);""!=a.bottom&&this.setBottom(a.bottom);if(""!=a.boxShadow){var b,d,f,h;-1<a.boxShadow.indexOf("rgb")?b=a.boxShadow.match(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/)[0]:a.boxShadow.indexOf("px")>a.boxShadow.indexOf(" ")&&(b=a.boxShadow.substr(0,a.boxShadow.indexOf(" ")));if(a=a.boxShadow.match(/([0-9]+px) ([0-9]+px) ([0-9]+px)/))d=parseInt(a[1]),f=parseInt(a[2]),h=
parseInt(a[3]);this.setShadow(d,f,b,h)}};d.prototype.setStrokeStyle=function(a){this._strokeStyle=a;this._changed=!0};d.prototype.getStrokeStyle=function(){return this._strokeStyle};d.prototype.setFillStyle=function(a){this._fillStyle=a;this._changed=!0};d.prototype.getFillStyle=function(){return this._fillStyle};d.prototype.setStrokeWidth=function(a){this._lineWidth=a;this._changed=!0};d.prototype.getStrokeWidth=function(){return this._lineWidth};d.prototype.setRadius=function(a){this._radius=a;
this._changed=!0};d.prototype.setShadow=function(a,b,d,e){this._shadow={x:a,y:b,color:d||"black",blur:e||1};this._changed=!0};d.prototype.getShadow=function(){return this._shadow};d.prototype.getRadius=function(){return this._radius};d.prototype.isMouseOver=function(a){a||(a=e.onLoopProperties);return e.Math2d.getDistance({x:this._x,y:this._y},a.mouse)<=this._radius};d.prototype.getWidth=function(){return this._scale?this._radius*this._scale.x:this._radius};d.prototype.getHeight=function(){return this._scale?
this._radius*this._scale.y:this._radius};d.prototype.getLeft=function(){return this._scale?this._x-this._radius*this._scale.x:this._x-this._radius};d.prototype.getRight=function(){return this._scale?this._x+this._radius*this._scale.x:this._x+this._radius};d.prototype.getTop=function(){return this._scale?this._y-this._radius*this._scale.y:this._y-this._radius};d.prototype.getBottom=function(){return this._scale?this._y+this._radius*this._scale.y:this._y+this._radius};d.prototype.setLeft=function(a){this._x=
this._scale?a+this._radius*this._scale.x:a+this._radius;this._changed=!0};d.prototype.setRight=function(a){this._x=this._scale?a-this._radius*this._scale.x:a-this._radius;this._changed=!0};d.prototype.setTop=function(a){this._y=this._scale?a+this._radius*this._scale.y:a+this._radius;this._changed=!0};d.prototype.setBottom=function(a){this._y=this._scale?a-this._radius*this._scale.y:a-this._radius;this._changed=!0};d.prototype.buffers={b:[],c:0};for(var a=0;9>a;a++){var h=document.createElement("canvas").getContext("2d");
h.elements=0;h.maxElements=600;h.canvas.width=3E4;h.canvas.height=50;d.prototype.buffers.b.push(h)}d.prototype.save=function(){var a=this.buffers.b[this.buffers.c];a.elements+1>a.maxElements&&(this.buffers.c++,a=this.buffers.b[this.buffers.c]);a.save();this._applyAlpha(a);a.translate(this._radius,this._radius);this._applyScale(a);this._applyShadow(a);this._lineWidth&&(a.lineWidth=this._lineWidth);a.beginPath();a.arc(2*a.elements*this._radius,0,this._radius,this._startAngle,this._endAngle,!1);a.closePath();
this._fillStyle&&(a.fillStyle=this._fillStyle,a.fill());this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.stroke(-this._radius,-this._radius,this._width,this._height));this.img=a.canvas;this.changed=!1;this.elementNumber=a.elements;a.elements++;a.restore()};d.prototype.onRender=function(a,b,d,e){this.changed&&this.save();b=2*this._radius;a.drawImage(this.img,this.elementNumber*b,0,b,b,this._x-this._radius,this._y-this._radius,b,b)};e.extend(d,b);f.Circle=d})(window.Match.renderers,window.Match,
window.Match.renderers.Renderizable);(function(f,e,b){function d(a){b.apply(this,arguments);this._weight=this._variant=this._style="";this._size="14px";this._family="Calibri, Verdana, Arial, Monospace";this._textAlign="center";this._textBaseline="middle";this._text="";this.set(a)}d.prototype.onRender=function(a,b,d,e){a.save();this._applyShadow(a);this._applyAlpha(a);this._applyTranslation(a,d,e);this._applyRotation(a);this._applyScale(a);a.font=this._style+this._variant+this._weight+this._size+this._family;a.textAlign=this._textAlign;
a.textBaseline=this._textBaseline;a.fillStyle=this._fillStyle;if(this.multiLine)for(b=0;b<this.multiLine.length;b++)a.fillText(this.multiLine[b],0,b*this.getHeight());else a.fillText(this._text,0,0);this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.lineWidth=this._lineWidth||1,a.strokeText(this._text,0,0));a.restore()};d.prototype.getRight=function(){return this._x+this.getWidth()};d.prototype.getBottom=function(){return this._y+this.getHeight()};d.prototype.getHeight=function(){if(this._text==
this._cachedText2)return this._height;var a=document.createElement("span"),b;a.font=this._style+this._variant+this._weight+this._size+this._family;a.textContent=this._text;document.body.appendChild(a);b=a.offsetHeight;document.body.removeChild(a);this._height=b;this._cachedText2=this._text;return b};d.prototype.setAlignment=function(a,b){this.setHorizontalAlign(a);this.setVerticalAlign(b)};d.prototype.setHorizontalAlign=function(a){this._textAlign=a;this.notifyChange()};d.prototype.setVerticalAlign=
function(a){this._textBaseline=a;this.notifyChange()};d.prototype.getWidth=function(){if(this._text==this._cachedText)return this._width;var a,b=e.offScreenContext;b.save();b.font=this._style+this._variant+this._weight+this._size+this._family;b.fillStyle=this._fillStyle;a=b.measureText(this._text).width;b.restore();this._width=a;this._cachedText=this._text;return a};d.prototype.setFamily=function(a){this._family=a;this.notifyChange()};d.prototype.setSize=function(a){this._size=parseInt(a)+"px ";this.notifyChange()};
d.prototype.setWeight=function(a){this._weight=a+" ";this.notifyChange()};d.prototype.setVariant=function(a){this._variant=a+" ";this.notifyChange()};d.prototype.setStyle=function(a){this._style=a+" ";this.notifyChange()};d.prototype.setFillStyle=function(a){this._fillStyle=a;this.notifyChange()};d.prototype.css=function(a){a=e.getStyleBySelector(a);""!=a.color&&this.setFillStyle(a.color);""!=a.fontFamily&&this.setFamily(a.fontFamily);""!=a.fontSize&&this.setSize(a.fontSize);""!=a.fontStyle&&this.setStyle(a.fontStyle);
""!=a.fontVariant&&this.setVariant(a.fontVariant);""!=a.fontWeight&&this.setWeight(a.fontWeight);""!=a.left&&this.setLeft(a.left);""!=a.right&&this.setRight(a.right);""!=a.top&&this.setTop(a.top);""!=a.bottom&&this.setBottom(a.bottom);if(""!=a.textShadow){var b,d,f,n;-1<a.textShadow.indexOf("rgb")?b=a.textShadow.match(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/)[0]:a.textShadow.indexOf("px")>a.textShadow.indexOf(" ")&&(b=a.textShadow.substr(0,a.textShadow.indexOf(" ")));if(a=a.textShadow.match(/([0-9]+px) ([0-9]+px) ([0-9]+px)/))d=
parseInt(a[1]),f=parseInt(a[2]),n=parseInt(a[3]);this.setShadow(d,f,b,n)}};d.prototype.getSize=function(a){return this._size};d.prototype.getWeight=function(a){return this._weight};d.prototype.getVariant=function(a){return this._variant};d.prototype.getStyle=function(a){return this._style};d.prototype.setStrokeStyle=function(a){this._strokeStyle=a;this.notifyChange()};d.prototype.setStrokeWidth=function(a){this._lineWidth=a;this._changed=!0};d.prototype.getStrokeWidth=function(){return this._lineWidth};
d.prototype.setText=function(a,b){b&&(this.multiLine=a.split("\n"));this._text=a;this.notifyChange()};d.prototype.getFamily=function(a){return this._family};d.prototype.getFillStyle=function(a){return this._fillStyle};d.prototype.getStrokeStyle=function(a){return this._strokeStyle};d.prototype.getText=function(){return this._text};d.prototype.setShadow=function(a,b,d,e){this._shadow={x:a,y:b,color:d||"black",blur:e||1};this.notifyChange()};d.prototype.getShadow=function(){return this._shadow};e.extend(d,
b);f.Text=d})(window.Match.renderers,window.Match,window.Match.renderers.Renderizable);(function(f){function e(b,d){b&&d&&this.createMap(d,b);this.renderingOptions={tileSize:114,colors:["white","black"]};this.rowCount=b;this.columnCount=d}e.prototype.createMap=function(b,d){this.map=[];this.rowCount=b;this.columnCount=d;for(var a=0;a<d;a++){for(var e=[],f=0;f<b;f++)e.push(0);this.map.push(e)}};e.prototype.fillCell=function(b,d){if(this.isValidCell(b,d)){if(1==this.map[b][d])return!1;this.map[b][d]=1}return!0};e.prototype.isValidCell=function(b,d){return 0<=b&&0<=d&&b<this.rowCount&&
d<this.columnCount};e.prototype.clearCell=function(b,d){this.isValidCell(b,d)&&(this.map[b][d]=0)};e.prototype.clear=function(){this.createMap(this.getRowCount(),this.getColumnCount())};e.prototype.onRender=function(b){for(var d=this.renderingOptions.tileSize,a=this.map,e=0,f=a.length;e<f;e++)for(var m=0,n=a[e].length;m<n;m++)a[e][m]&&(b.fillStyle=this.renderingOptions.colors[a[e][m]],b.fillRect(m*d,e*d,d,d))};e.prototype.isEmpty=function(b,d){return this.isValidCell(b,d)&&0==this.map[b][d]};e.prototype.isVisible=
function(){return!0};f.CollisionMap=e})(Match.collisions);
