var M=window.M||{};
(function(g){function e(){var a="Firefox;Chrome;Opera;Safari;MSIE 9.0;BlackBerry".split(";"),f,d;this.name=void 0;for(f in a)d=a[f],this["is"+d]=-1!=navigator.userAgent.indexOf(d),!this.name&&this["is"+d]&&(this.name=d);this.supportedAudioFormat=this.getBrowserPreferredAudioFormat();this.supported=void 0!=this.name}function b(){var a="Android BlackBerry iPhone iPad iPod IEMobile".split(" "),f;for(f in a)deviceName=a[f],this["is"+deviceName]=-1!=navigator.userAgent.indexOf(deviceName),!this.name&&
this["is"+deviceName]&&(this.name=deviceName);this.name?this.isMobile=!0:(this.isMobile=!1,this.name="PC")}function d(){window.requestAnimFrame(d);window.Match.gameLoop()}function a(){this._isPlaying=!1;this._gameLayers=[];this._gameObjects=[];this._gameObjectsToAdd=[];this.cache=null;this.offScreenCanvas=document.createElement("canvas");this.offScreenContext=this.offScreenCanvas.getContext("2d");this.onLoopProperties={offScreenContext:this.offScreenContext,offScreenCanvas:this.offScreenCanvas,debug:!1,
time:0};this.browser=new e;this.device=new b;this.setDoubleBuffer(!1);var a=this;document.addEventListener("DOMContentLoaded",function(){a.setUpGameLoop()})}g.Match||(e.prototype.getBrowserPreferredAudioFormat=function(){var a=document.createElement("audio");if(""!=a.canPlayType("audio/ogg"))return".ogg";if(""!=a.canPlayType("audio/mpeg"))return".mp3";if(""!=a.canPlayType("audio/wav"))return".wav";if(""!=a.canPlayType("audio/mp4"))return".mp4";console.warn("This browser does not support audio")},
e.prototype.getBrowserAudioSupportedFormats=function(){var a=document.createElement("audio"),f=[];""!=a.canPlayType("audio/ogg")&&f.push(".ogg");""!=a.canPlayType("audio/mpeg")&&f.push(".mp3");""!=a.canPlayType("audio/wav")&&f.push(".wav");""!=a.canPlayType("audio/mp4")&&f.push(".mp4");return f.join("|")},a.prototype={setUpGameLoop:function(){this.gameLoopAlreadySetup=!0;d();"function"==typeof window.main&&window.main()},setDebug:function(a){this.onLoopProperties.debug=a},setKeyboard:function(a){this.keyboard=
a;this.onLoopProperties.keyboard=a;this._buildInputMapping()},setMouse:function(a){this.mouse=a;this.onLoopProperties.mouse=a;this._buildInputMapping()},setTouch:function(a){this.touch=a;this.onLoopProperties.touch=a;this._buildInputMapping()},setAccelerometer:function(a){this.accelerometer=a;this.onLoopProperties.accelerometer=a;this._buildInputMapping()},setOrientation:function(a){this.orientation=a;this.onLoopProperties.orientation=a;this._buildInputMapping()},renderSingleBuffer:function(a,f,d){var b=
a.length,e=0,g=this.frontBuffer;for(g.clearRect(0,0,f.width,f.height);e<b;e++)if(g.drawImage(a[e].onLoop(d),0,0),this.frontBuffers)for(var n=f.width,r=f.height,s,t=0;t<this.frontBuffers.length;t++)s=this.frontBuffers[t],s.clearRect(0,0,n,r),s.drawImage(g.canvas,0,0)},renderDoubleBuffer:function(a,f,d){var b=a.length,e=0,g,n=this.backBuffer;for(n.clearRect(0,0,f.width,f.height);e<b;e++){g=a[e];var r=g.onLoop(d);n.save();g.composite&&(n.globalCompositeOperation=g.composite);null!=g._alpha&&(0<=g._alpha&&
1>=g._alpha)&&(n.globalAlpha=g._alpha);n.translate(n.halfWidth,n.halfHeight);g.rotation&&n.rotate(g.rotation);g.scale&&n.scale(g.scale.x,g.scale.y);n.drawImage(r,-n.halfWidth,-n.halfHeight);n.restore()}this.frontBuffer.clearRect(0,0,f.width,f.height);this.frontBuffer.drawImage(n.canvas,0,0);this.pepe=!0},updateGameObjects:function(a,f){for(var d in a){var b=a[d];this._applyInput&&this._applyInput(f,b);if(b.onLoop)b.onLoop(f);b.children&&this.updateGameObjects(b.children,f)}},_buildInputMapping:function(){var a=
this.onLoopProperties,f="",d="";a.keyboard&&(f+="p.keyboard.applyToObject(node);",d+="p.keyboard.update();");a.mouse&&(f+="p.mouse.applyToObject(node);",d+="p.mouse.update();");a.touch&&(f+="p.touch.applyToObject(node);",d+="p.touch.update();");a.accelerometer&&(f+="p.accelerometer.applyToObject(node);",d+="p.accelerometer.update();");a.orientation&&(f+="p.orientation.applyToObject(node);",d+="p.orientation.update();");this._applyInput=new Function("p","node",f);this._updateInput=new Function("p",
d)},gameLoop:function(){if(this._isPlaying){if(this.onBeforeLoop)this.onBeforeLoop();var a=this.onLoopProperties;a.time=this.FpsCounter.timeInMillis;this.updateGameObjects(this._gameObjects,a);this._updateInput&&this._updateInput(a);this.render(this._gameLayers,this.frontBuffer.canvas,a);a.debug&&(this.frontBuffer.font="18px sans-serif",this.frontBuffer.fillStyle="yellow",this.frontBuffer.fillText(this.getFps()+"fps",20,20));this.FpsCounter.count();if(this.onAfterLoop)this.onAfterLoop()}},getAsBase64Image:function(){return this.frontBuffer.canvas.toDataURL()},
getAsImage:function(){var a=new Image;a.src=this.getAsBase64Image();return a},getFirst:function(){return this.getIndex(0)},getIndex:function(a){try{return this._gameObjects[a]}catch(d){return null}},get:function(a){if(this.cache&&this.cache.key==a)return this.cache;for(var d=this._gameObjects.length,b;d--;)if(b=this._gameObjects[d],a==b.key)return this.cache=b;return null},getLast:function(){return this.getIndex(this._gameObjects.length-1)},isInOnLoopList:function(a){return-1!=this._gameObjects.indexOf(a)},
pushGameObject:function(a){if(!a.onLoop)throw Error("Cannot add object with no onLoop method "+a.constructor.name);this._gameObjects.push(a)},pushObject:function(a){this.pushGameObject(a)},removeGameObject:function(a){void 0!=a&&("string"==typeof a?this.removeGameObject(this.get(a)):isNaN(a)?(a=this._gameObjects.indexOf(a),-1!=a&&this._gameObjects.splice(a,1)):this._gameObjects.splice(a,1))},removeAllGameObjects:function(){this._gameObjects=[]},createNewContext:function(){return window.document.createElement("canvas").getContext("2d")},
setDoubleBuffer:function(a){a?(this.backBuffer=this.createNewContext(),this.updateBufferSize(),this.render=this.renderDoubleBuffer):this.render=this.renderSingleBuffer},isDoubleBuffered:function(){return this.render==this.renderDoubleBuffer},setCanvasSize:function(a,d){this.frontBuffer&&(this.frontBuffer.canvas.width=a,this.frontBuffer.canvas.height=d,this.updateBufferSize())},updateBufferSize:function(){this.frontBuffer&&(this.backBuffer&&this.frontBuffer&&(this.backBuffer.canvas.width=this.frontBuffer.canvas.width,
this.backBuffer.canvas.height=this.frontBuffer.canvas.height,this.backBuffer.halfWidth=this.backBuffer.canvas.width/2,this.backBuffer.halfHeight=this.backBuffer.canvas.height/2),this.offScreenCanvas.width=this.frontBuffer.canvas.width,this.offScreenCanvas.height=this.frontBuffer.canvas.height,this.collisions.PixelPerfect&&(this.collisions.PixelPerfect.testContext.canvas.width=this.offScreenCanvas.width,this.collisions.PixelPerfect.testContext.canvas.height=this.offScreenCanvas.height),this.updateViewport())},
createGameLayer:function(){var a=new this.GameLayer;this.frontBuffer&&a.setBufferSize(this.frontBuffer.canvas);this.pushGameLayer(a);return a},createLayer:function(){return this.createGameLayer()},pushGameLayer:function(a){if(!a)throw Error("Cannot add null game layer");this.frontBuffer&&a.setBufferSize(this.frontBuffer.canvas);this._gameLayers.push(a)},pushLayer:function(a){this.pushGameLayer(a)},removeScene:function(){var a=this._gameLayers;this._gameLayers=[];return a},pushScene:function(a){for(var d=
0,b=a.length;d<b;d++)this.pushGameLayer(a[d])},swapScenes:function(a){a=this.removeScene();this.pushScene(a);return a},removeGameLayer:function(a){a||(a=this._gameLayers[0]);this.removeElementFromArray(a,this._gameLayers);for(var d in a.onRenderList)this.removeGameObject(a.onRenderList[d])},removeAllGameLayers:function(){for(var a=0;a<this._gameLayers.length;a++){var d=this._gameLayers[a],b;for(b in d.onRenderList)this.removeGameObject(d.onRenderList[b])}this._gameLayers=[]},getSpeed:function(a){return a/
this.getAverageFps()},getFps:function(){return this.FpsCounter.fps},getAverageFps:function(){return this.FpsCounter.getAverageFps()},getGameTime:function(){return this.FpsCounter.gameTime},getTime:function(){return this.FpsCounter.timeInMillis},clearFrontBuffer:function(){this.frontBuffer&&this.frontBuffer.clearRect(0,0,this.frontBuffer.canvas.width,this.frontBuffer.canvas.height)},pause:function(){if(this._isPlaying){if(this.onPause)this.onPause()}else if(this.onUnPause)this.onUnPause();this._isPlaying=
!this._isPlaying},addCanvas:function(a){this.frontBuffers||(this.frontBuffers=[]);a.width=this.frontBuffer.canvas.width;a.height=this.frontBuffer.canvas.height;this.frontBuffers.push(a.getContext("2d"))},start:function(a,d){a||(a=M.dom("canvas"));if(!(a instanceof HTMLCanvasElement))throw Error("start is expecting an HTMLCanvasElement as argument");a.onselectstart=function(){return!1};a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullScreen;
this.frontBuffer=a.getContext("2d");this.updateBufferSize();this.updateViewport();for(var b=0,k=this._gameLayers.length;b<k;b++)this._gameLayers[b].setBufferSize(a);this._isPlaying=!0;this.gameLoopAlreadySetup||this.setUpGameLoop()},updateViewport:function(){this.camera.setViewport(this.frontBuffer.canvas.width,this.frontBuffer.canvas.height)},getViewportSize:function(){return{width:this.camera.viewportWidth,height:this.camera.viewportHeight}},removeIndexFromArray:function(a,d){d.splice(a,1)},removeElementFromArray:function(a,
d){var b=d.indexOf(a);-1!=b&&this.removeIndexFromArray(b,d)},dom:function(a){return document.querySelector(a)},applyProperties:function(a,d,b){if(a&&d){if(b){if(!d)throw Error("Cannot apply null properties to "+a.constructor.name);for(var k=b.length;k--;)if(!d[b[k]])throw Error("Unable to apply properties to ["+a.constructor.name+"] You must specify ["+b[k]+"]");}b="";for(k in d)if(b="set"+k.charAt(0).toUpperCase()+k.substr(1),a[b])a[b](d[k]);else a[k]=d[k];return a}},apply:function(){for(var a=arguments[0],
d=1;d<arguments.length;d++){var b=arguments[d];if(b)if(b instanceof Function){var k=new b,e;for(e in k)b.prototype[e]||a[e]||(a[e]=k[e])}else for(e in b)a[e]||(a[e]=b[e])}},put:function(a,d){for(var b in d)a[b]=d[b]},clone:function(a){for(var d in a)c[d]=a[d];return{}},each:function(a,d,b){var k=a.length;if(b)for(;k--;)d.call(b,a[k]);else for(;k--;)d.call(a[k])},extend:function(a,d){for(var b in d.prototype)a.prototype[b]||(a.prototype[b]=d.prototype[b])},round:function(a,d){for(var b="1";d--;)b+=
"0";d=parseInt(b);return Math.round(a*d)/d},getPercentage:function(a,d){return a*d/100},elapsedTimeFrom:function(a,d){return M.getTime()-a>=d},isPaused:function(){return!this._isPlaying},getStyleBySelector:function(a){var d=document.styleSheets,b,k,e;for(k=d.length-1;0<=k;k--)for(b=d[k].cssRules,e=0;e<b.length;e++)if(b[e].type==CSSRule.STYLE_RULE&&b[e].selectorText==a)return b[e].style;return null},setFullScreen:function(){this.frontBuffer&&this.frontBuffer.canvas.requestFullScreen&&this.frontBuffer.canvas.requestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}},
window.console?(window.console.log&&(window.console.debug=window.console.log),window.console.warn||(window.console.warn=window.console.debug)):(window.console={},window.console.log=window.console.debug=window.console.error=window.console.warning=function(){}),HTMLElement.prototype.remove=function(){this.parentNode.removeChild(this)},HTMLElement.prototype.setClass=function(a){this.setAttribute("class",a)},HTMLCanvasElement.prototype.getCenter=function(){return{x:this.width/2,y:this.height/2}},HTMLCanvasElement.prototype.setSize=
function(a,d){this.width=a;this.height=d},HTMLCanvasElement.prototype.adjustTo=function(a,d){this.style.setProperty("width",a+"px",null);this.style.setProperty("height",d+"px",null)},HTMLCanvasElement.prototype.adjustToAvailSize=function(){this.adjustTo(window.screen.availWidth+"px",window.screen.availHeight+"px")},HTMLCanvasElement.prototype.resizeKeepingAspect=function(a){this.adjustTo(this.width*a,this.height*a)},HTMLCanvasElement.prototype.getRight=function(){return this.offsetLeft+this.offsetWidth},
HTMLCanvasElement.prototype.getBottom=function(){return this.offsetTop+this.offsetHeight},HTMLCanvasElement.prototype.getAvailWidth=function(){return this.getRight()<window.screen.availWidth?this.offsetWidth:window.screen.availWidth-this.offsetLeft},HTMLCanvasElement.prototype.getAvailHeight=function(){return this.getBottom()<window.screen.availHeight?this.offsetHeight:window.screen.availHeight-this.offsetTop},HTMLCanvasElement.prototype.getViewport=function(){var a={};a.left=0>this.offsetLeft?-this.offsetLeft:
0;a.top=0>this.offsetTop?-this.offsetTop:0;a.right=this.offsetLeft+this.offsetWidth>window.screen.availWidth?window.screen.availWidth-this.offsetLeft:this.offsetWidth;a.bottom=this.offsetTop+this.offsetHeight>window.screen.availHeight?window.screen.availHeight-this.offsetTop:this.offsetHeight;return a},HTMLCanvasElement.prototype.getAspect=function(){var a={x:1,y:1};this.style.width&&this.width!=parseInt(this.style.width)&&(a.x=this.width/parseInt(this.style.width));this.style.height&&this.height!=
parseInt(this.style.height)&&(a.y=this.height/parseInt(this.style.height));return a},CanvasRenderingContext2D.prototype.resetOperation=function(){this.operationChanged&&"source-over"!=this.globalCompositeOperation&&(this.globalCompositeOperation="source-over",this.operationChanged=!1)},CanvasRenderingContext2D.prototype.resetAlpha=function(){this.alphaChanged&&1!=this.globalAlpha&&(this.globalAlpha=1,this.alphaChanged=!1)},CanvasRenderingContext2D.prototype.resetShadow=function(){this.shadowChanged&&
(0!=this.shadowBlur&&(this.shadowBlur=0),0!=this.shadowOffsetX&&(this.shadowOffsetX=0),0!=this.shadowOffsetY&&(this.shadowOffsetY=0),this.shadowChanged=!1)},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}(),g.M=g.Match=new a)})(window);(function(g){function e(){this.listeners=[]}e.prototype.addEventListener=function(b,d){d&&(b=b.bind(d));this.listeners.push(b)};e.prototype.raise=function(){for(var b=0,d=this.listeners.length;b<d;b++)this.listeners[b](arguments)};e.prototype.removeEventListener=function(b){b=this.listeners.indexOf(b);-1<b&&this.listeners.splice(b,1)};e.prototype.removeAllEventListeners=function(){this.listeners=[]};g.EventListener=e})(window.Match);(function(g){function e(){this.lastTime=(new Date).getTime();this._currentFps=0;this.fps="";this.gameTime=1;this.totalFps=this.timeInMillis=0}e.prototype.reset=function(){this.fps="";this.timeInMillis=this._currentFps=this.totalFps=0;this.gameTime=1};e.prototype.count=function(){this.timeInMillis=(new Date).getTime();1E3<=this.timeInMillis-this.lastTime?(this.lastTime=this.timeInMillis,this.fps=this._currentFps,this.gameTime++,this.totalFps+=this.fps,this._currentFps=0):this._currentFps++};e.prototype.getAverageFps=
function(){return 0==this.totalFps?60:Math.floor(this.totalFps/this.gameTime)};g.FpsCounter=new e})(window.Match);(function(g){function e(){this.hasFocus=!1;this.children={}}e.prototype.removeChild=function(b){this.children[b]=null};e.prototype.onLoop=function(){throw Error("Method GameObject.onLoop is abstract and must be overriden");};g.GameObject=e})(window.M);(function(g){function e(){this.math=Math}function b(d,a){this.x=d;this.y=a}e.prototype.getXFromCircle=function(d,a,b){return d+a*this.math.cos(b)};e.prototype.getYFromCircle=function(d,a,b){return d+a*this.math.sin(b)};e.prototype.getPointFromCircle=function(d,a,b,f){return this.getPointFromElipsis(d,a,b,b,f)};e.prototype.getPointFromElipsis=function(d,a,h,f,m){return new b(this.getXFromCircle(d,h,m),this.getYFromCircle(a,f,m))};e.prototype.getVector2d=function(d,a){return new b(a.x-d.x,a.y-d.y)};
e.prototype.getVector=function(d,a){return this.getVector2d(d,a)};e.prototype.getRotatedVertex=function(d,a){return new b(d.x*this.math.cos(a)-d.y*this.math.sin(a),d.y*this.math.cos(a)+d.x*this.math.sin(a))};e.prototype.getMagnitude=function(d){return this.math.sqrt(d.x*d.x+d.y*d.y)};e.prototype.getSquareDistance=function(d,a){var b=d.x-a.x,f=d.y-a.y;return b*b+f*f};e.prototype.getAngleBetweenVectors=function(d,a){var b=this.getMagnitude(d)*this.getMagnitude(a);return this.math.acos((d.x*a.x+d.y*
a.y)/b)};e.prototype.getCosBetweenVectors=function(d,a){var b=this.getMagnitude(d)*this.getMagnitude(a);return(d.x*a.x+d.y*a.y)/b};e.prototype.getDistance=function(d,a){return this.math.sqrt(this.getSquareDistance(d,a))};e.prototype.haveTheSameDirection=function(d,a){return 0<d.x&&0>a.x||0>d.x&&0<a.x||0<d.y&&0>a.y||0>d.y&&0<a.y?!1:!0};e.prototype.areParallelVectors=function(d,a){d=this.getNormalized(d);a=this.getNormalized(a);var b=d.x/a.x,f=d.y/a.y;return b>=f-0.1&&b<=f+0.1};e.prototype.getNormalized=
function(d){var a=this.getMagnitude(d);return new b(d.x/a,d.y/a)};e.prototype.substract=function(d,a){return new b(d.x-a.x,d.y-a.y)};e.prototype.add=function(d,a){return new b(d.x+a.x,d.y+a.y)};e.prototype.scalarProduct=function(d,a){return new b(d.x*a,d.y*a)};e.prototype.rotateIfNeeded=function(d,a,b){if(!this.areParallelVectors(d,a)||!this.haveTheSameDirection(d,a)){var f=this.getSquareDistance(d,a),m=this.getRotatedVertex(d,b);if(this.getSquareDistance(m,a)<f)return d.x=m.x,d.y=m.y,b;a=this.getRotatedVertex(d,
-b);d.x=a.x;d.y=a.y;return-b}return 0};g.math2d=g.Math2d=new e;g.math2d.Vector2d=b})(window.Match);(function(g,e){function b(d){this.objects=[];this.mode=null;this.setMode(d||"Polygon")}b.prototype={reset:function(){this.objects=[]},onLoop:function(){for(var d=0,a=1;d<this.objects.length;){for(;a<this.objects.length;)this.checkCollisions(this.objects[d],this.objects[a]),a++;d++;a=d+1}for(d=this.objects.length;d--;)this.objects[d]._visible||g.removeIndexFromArray(d,this.objects)},canCollide:function(d,a){if(d.cantCollideType)for(var b=d.cantCollideType.length;b--;)if(a instanceof d.cantCollideType[b])return!1;
if(d.cantCollide)for(b=d.cantCollide.length;b--;)if(d.cantCollide[b]==a)return!1;return!0},checkCollisions:function(d,a){if(this.canCollide(d,a)&&this.canCollide(a,d)&&this.mode.haveCollided(d,a)){if(d.onCollision)d.onCollision(a);if(a.onCollision)a.onCollision(d)}},setMode:function(d,a){this.mode="string"===typeof d?g.collisions[d]:d},push:function(d){this.objects.push(d)},removeType:function(d){for(var a=this.objects.length;a--;)this.objects[a]instanceof d&&this.remove(this.objects[a])}};e.AllvsAllCollisionHandler=
b})(window.Match,window.Match.collisions||(window.Match.collisions={}));(function(g,e){function b(d){this.colliders=[];this.collidables=[];this.setMode(d||"Polygon");this.collidableCallback=this.colliderCallback="onCollision"}b.prototype={onLoop:function(){for(var d=this.colliders.length;d--;)this.checkCollisions(this.colliders[d],this.collidables)},checkCollisions:function(d,a){if(d)for(var b=a.length,f=null;b--;){f=a[b];if(!f)break;if(f instanceof Array)this.checkCollisions(d,f);else if(this.mode.haveCollided(d,f)){if(d[this.colliderCallback])d[this.colliderCallback](f);
if(f[this.collidableCallback])f[this.collidableCallback](d)}}},setMode:function(d){this.mode="string"===typeof d?g.collisions[d]:d}};e.CollisionHandler=b})(window.Match,window.Match.collisions||(window.Match.collisions={}));(function(g,e){function b(){this.math2d=e}b.prototype={getCollisionArea:function(d){var a=[],b=d.getWidth()/2,f=d.getHeight()/2;a.push({x:-b,y:-f});a.push({x:b,y:-f});a.push({x:b,y:f});a.push({x:-b,y:f});this.rotate(a,d._rotation);this.translate(a,d._x,d._y);return a},translate:function(d,a,b){for(var f=0;f<d.length;f++)d[f].x+=a,d[f].y+=b},rotate:function(d,a){if(a)for(var b=0;b<d.length;b++)d[b]=this.math2d.getRotatedVertex(d[b],a)},haveCollided:function(d,a){for(var b=this.getCollisionArea(a),
f=this.getCollisionArea(d),m=0;m<f.length;m++)if(this.pointInPolygon(f[m].x,f[m].y,b)||this.pointInPolygon(b[m].x,b[m].y,f))return!0;return!1},pointInPolygon:function(d,a,b){var f,m,k=!1,e=b.length,g;f=0;for(m=e-1;f<e;m=f++)g=b[f],m=b[m],g.y>a!=m.y>a&&d<(m.x-g.x)*(a-g.y)/(m.y-g.y)+g.x&&(k=!k);return k}};g.Polygon=new b})(window.Match.collisions||(window.Match.collisions={}),window.Match.math2d);(function(g){function e(){}e.prototype={haveCollided:function(b,d){var a=0,h=0,a=b._halfWidth>b._halfHeight?b._halfWidth:b._halfHeight,h=d._halfWidth>d._halfHeight?d._halfWidth:d._halfHeight;return b._y+a<d._y-h||b._y-a>d._y+h||b._x+a<d._x-h||b._x-a>d._x+h?!1:!0}};g.Square=new e})(window.Match.collisions||(window.Match.collisions={}));(function(g,e){function b(d){this.math2d=e}b.prototype={haveCollided:function(d,a){var b=d.getWidth()*d.getHeight()/2,f=a.getWidth()*a.getHeight()/2,b=b<f?b:f;return this.math2d.getSquareDistance(d.getLocation(),a.getLocation())<=b*b}};g.Radial=new b})(window.Match.collisions||(window.Match.collisions={}),window.Match.math2d);(function(g){function e(){}e.prototype={haveCollided:function(b,d){return b.getBottom()<d.getTop()||b.getTop()>d.getBottom()||b.getRight()<d.getLeft()||b.getLeft()>d.getRight()?!1:!0}};g.Simple=new e})(window.Match.collisions||(window.Match.collisions={}));(function(g,e){function b(){this.testContext=document.createElement("canvas").getContext("2d")}b.prototype.haveCollided=function(b,a){var h=window.Math,f=h.min(b.getLeft(),a.getLeft()),e=h.min(b.getTop(),a.getTop()),k=h.max(b.getRight(),a.getRight())-f,g=h.max(b.getBottom(),a.getBottom())-e,p=this.testContext,n=h=0;p.clearRect(f,e,k,g);p.save();b.onRender(p,p.canvas,0,0);p.globalCompositeOperation="source-in";a.onRender(p,p.canvas,0,0);p.restore();for(f=p.getImageData(f,e,k,g);h<f.width;){for(;n<
f.height;){if(0!=f.data[4*(n*f.width+h)+3])return!0;n++}h++;n=0}return!1};e.PixelPerfect=new b})(window.Match,window.Match.collisions||(window.Match.collisions={}));(function(g){function e(){this._halfViewportWidth=this._halfViewportHeight=this.viewportHeight=this.viewportWidth=this.y=this.x=0}e.prototype.setViewport=function(b,d){this.viewportWidth=b;this.viewportHeight=d;this._halfViewportWidth=b/2;this._halfViewportHeight=d/2};e.prototype.centerAtRenderizable=function(b){this.x=b._x-this._halfViewportWidth;this.y=b._y-this._halfViewportHeight};e.prototype.centerAt=function(b,d){this.x=b-this._halfViewportWidth;this.y=d-this._halfViewportHeight};g.onLoopProperties.camera=
g.camera=new e})(window.Match);(function(g){function e(a){g.mouse.mousedown(a)}function b(a){g.mouse.mouseup(a)}function d(a){g.mouse.click(a)}function a(a){g.mouse.mousemove(a)}function h(a){g.mouse.mousewheel(a)}function f(a){g.mouse.DOMMouseScroll(a)}function m(){this.events={0:{},1:{},2:{}};this.y=this.x=null;this.isDragging=!1;g.browser.isFirefox?document.addEventListener("DOMMouseScroll",f,!1):"MSIE 9.0"==g.browser.name?document.addEventListener("onwheel",h,!1):document.addEventListener("mousewheel",h,!1);document.addEventListener("mousedown",
e,!1);document.addEventListener("mouseup",b,!1);document.addEventListener("mousemove",a,!1);document.addEventListener("click",d,!1)}m.prototype={LEFT:0,MIDDLE:1,RIGHT:2,select:function(a){this.isDragging||(this.selectedObject=a)},fireEventOnLastSelectedObject:function(){var a=this.selectedObject,b=this.prevSelectedObject;if(a){a.onMouseIn&&!a._mouseInRaised&&(a._mouseInRaised=!0,a.onMouseIn(this));if(b&&b!=a&&(b._mouseInRaised=!1,b.onMouseOut))b.onMouseOut(this);if(a.onMouseUp&&this.up())a.onMouseUp(this);
if(a.onClick&&this.clicked())a.onClick(this);if(this.down()){if(a.onMouseDown)a.onMouseDown(this);this.isDragging=!0;if(a.onDrag)a.onDrag(this)}if(a.onMouseOver)a.onMouseOver(this);if(a.onMouseMove&&this.moved())a.onMouseMove(this);if(a.onMouseWheel&&this.wheel())a.onMouseWheel(this)}else b&&b.onMouseOut&&(b._mouseInRaised=!1,b.onMouseOut(this));this.prevSelectedObject=a;this.isDragging||(this.selectedObject=null)},clicked:function(a){return null!=a?this.events[a].click:this.events[0].click},down:function(a){return null!=
a?this.events[a].down:this.events[0].down||this.events[1].down||this.events[2].down},up:function(a){return null!=a?this.events[a].up:this.events[0].up||this.events[1].up||this.events[2].up},moved:function(){return this.eventMouseMove},wheel:function(){this.wheelDeltaY=0;this.eventMouseWheel&&(this.wheelDeltaY=this.eventMouseWheel.wheelDeltaY);return this.wheelDeltaY},clear:function(){for(var a=0;3>a;a++)this.events[a].up=null,this.events[a].click=null;this.eventMouseMove=this.eventMouseWheel=null},
click:function(a){this.events[a.button].click=a;this.x=a.offsetX;this.y=a.offsetY},mousedown:function(a){this.events[a.button].down=a},mouseup:function(a){this.events[a.button].down=null;this.events[a.button].up=a;this.isDragging=!1},mousewheel:function(a){this.eventMouseWheel=a},DOMMouseScroll:function(a){this.mousewheel({wheelDeltaY:-40*a.detail})},isOverPixelPerfect:function(a){if(a.onRender&&a._visible){var b=g.offScreenContext,d=g.offScreenCanvas,f=g.camera;b.save();b.clearRect(0,0,d.width,d.height);
a.onRender(b,d,f.x,f.y);a=b.getImageData(this.x,this.y,1,1);return a.data[3]?a.data[0]||a.data[1]||a.data[2]?!0:!1:!1}},isOverPolygon:function(a){var b=g.camera,d=this.x+b.x,b=this.y+b.y;return a._rotation?(this._x=d,this._y=b,g.collisions.Polygon.haveCollided(a,this)):a.getBottom()<b||a.getTop()>b||a.getRight()<d||a.getLeft()>d?!1:!0},getHeight:function(){return 2},getWidth:function(){return 2},update:function(){this.fireEventOnLastSelectedObject();this.clear()},applyToObject:function(a){(a.onMouseOver||
a.onMouseIn||a.onMouseOut||a.onMouseWheel||a.onMouseDown&&this.down()||a.onMouseUp&&this.up()||a.onClick&&this.clicked())&&this.isOverPolygon(a)&&this.isOverPixelPerfect(a)&&this.select(a)}};g.browser.isFirefox?(m.prototype.mousemove=function(a){this.eventMouseMove=a;this.x=a.layerX-a.target.offsetLeft;this.y=a.layerY-a.target.offsetTop},m.prototype.click=function(a){this.events[a.button].click=a;this.x=a.layerX-a.target.offsetLeft;this.y=a.layerY-a.target.offsetTop}):m.prototype.mousemove=function(a){this.eventMouseMove=
a;this.x=a.offsetX;this.y=a.offsetY};g.setMouse(new m)})(window.Match);(function(g){function e(a){d.accelerate(a)}function b(){window.addEventListener("devicemotion",e,!1)}var d;b.prototype.accelerate=function(a){this._hasEvent=!0;this.accelerationIncludingGravity=a.accelerationIncludingGravity;this.acceleration=a.acceleration;this.rotationRate=a.rotationRate};b.prototype.update=function(){this._hasEvent=!1};b.prototype.applyToObject=function(a){if(this._hasEvent){if(a.onDeviceAccelerationIncludingGravity)a.onDeviceAccelerationIncludingGravity(this.accelerationIncludingGravity.x,
this.accelerationIncludingGravity.y,this.accelerationIncludingGravity.z,this.rotationRate);if(a.onDeviceAcceleration)a.onDeviceAcceleration(this.acceleration.x,this.acceleration.y,this.acceleration.z,this.rotationRate);if(a.onDeviceRotation)a.onDeviceRotation(this.rotationRate.alpha,this.rotationRate.beta,this.rotationRate.gamma)}};d=new b;g.setAccelerometer(d)})(window.Match);(function(g){function e(a){g.keyboard.fireDown(a)}function b(a){g.keyboard.fireUp(a)}function d(){document.addEventListener("keydown",e,!1);document.addEventListener("keyup",b,!1)}d.prototype={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",
122:"f11",123:"f12",145:"numlock",220:"pipe",keysDown:{length:0},keysUp:null,keysPressed:{},fireDown:function(a){a=this[a.which]||String.fromCharCode(a.which).toLowerCase();this.keysDown[a]=!0;void 0==this.keysPressed[a]&&(this.keysPressed[a]=!0);this.keysDown.length++},fireUp:function(a){a=this[a.which]||String.fromCharCode(a.which).toLowerCase();this.keysUp||(this.keysUp={});this.keysDown[a]=!1;this.keysPressed[a]=void 0;this.keysUp[a]=!0;0<this.keysDown.length&&this.keysDown.length--},update:function(){this.keysUp=
null;for(var a in this.keysPressed)!0==this.keysPressed[a]&&(this.keysPressed[a]=!1)},applyToObject:function(a){if(a.hasFocus){if(a.onKeyDown)a.onKeyDown(this.keysDown);if(a.onKeyUp)a.onKeyUp(this.keysUp);if(a.keyDownMappings&&0<this.keysDown.length)for(var b in a.keyDownMappings)if(this.keysDown[b])a[a.keyDownMappings[b]]();if(a.keyUpMappings&&this.keysUp)for(b in a.keyUpMappings)if(this.keysUp[b])a[a.keyUpMappings[b]]()}},getKeyCode:function(a){return a.charCodeAt(0)}};g.setKeyboard(new d)})(window.Match);(function(g){function e(a){h.start(a)}function b(a){h.end(a)}function d(a){h.move(a)}function a(){document.addEventListener("touchstart",e,!1);document.addEventListener("touchend",b,!1);document.addEventListener("touchmove",d,!1);this.y=this.x=0;this.isDragging=!1;this.events={start:null,end:null,move:null}}var h;a.prototype.clear=function(){this.events.end&&(this.events.start=null,this.y=this.x=0);this.events.end=null;this.force=this.events.move=null;this.isDragging||(this.selectedObject=null)};
a.prototype.update=function(){this.fireEventOnLastSelectedObject(this);this.clear()};a.prototype.getHeight=function(){return 2};a.prototype.getWidth=function(){return 2};a.prototype.applyToObject=function(a){!this.isDragging&&((a.onTouch||a.onTouchEnd||a.onTouchMove||a.onDrag)&&this.isOverPolygon(a)&&this.isOverPixelPerfect(a))&&(this.selectedObject=a)};a.prototype._setTouch=function(a){this.x=a.pageX-a.target.offsetLeft;this.y=a.pageY-a.target.offsetTop;this.force=a.force};a.prototype.start=function(a){a=
a.changedTouches;a.length&&(a=a[0],this._setTouch(a),this.events.start=a)};a.prototype.end=function(a){a=a.changedTouches;a.length&&(this.events.end=a[0],this.isDragging=!1,this.selectedObject=null)};a.prototype.move=function(a){a=a.changedTouches;a.length&&(a=a[0],this._setTouch(a),this.events.move=a)};a.prototype.started=function(){return this.events.start};a.prototype.moved=function(){return this.events.move};a.prototype.ended=function(){return this.events.end};a.prototype.fireEventOnLastSelectedObject=
function(){if(this.selectedObject){if(this.events.start){if(this.selectedObject.onTouch)this.selectedObject.onTouch(this);this.selectedObject.onDrag&&(this.isDragging=!0)}if(this.events.end&&this.selectedObject.onTouchEnd)this.selectedObject.onTouchEnd(this);if(this.events.move){if(this.selectedObject.onTouchMove)this.selectedObject.onTouchMove(this);if(this.isDragging)this.selectedObject.onDrag(this)}}};a.prototype.isOverPixelPerfect=function(a){if(a.onRender&&a._visible){var b=g.offScreenContext,
d=g.offScreenCanvas,h=g.camera;b.save();b.clearRect(0,0,d.width,d.height);a.onRender(b,d,h.x,h.y);a=b.getImageData(this.x,this.y,1,1);return a.data[3]?a.data[0]||a.data[1]||a.data[2]?!0:!1:!1}};a.prototype.isOverPolygon=function(a){var b=g.camera,d=this.x+b.x,b=this.y+b.y;return a._rotation?(this._x=d,this._y=b,g.collisions.Polygon.haveCollided(a,this)):a.getBottom()<b||a.getTop()>b||a.getRight()<d||a.getLeft()>d?!1:!0};h=new a;g.setTouch(h)})(window.Match);(function(g){function e(){}e.prototype.rgb=function(b,d,a){return"rgb("+[b,d,a].join()+")"};e.prototype.rgba=function(b,d,a,h){return"rgba("+[b,d,a,h].join()+")"};e.prototype.rgbToHex=function(b,d,a){return"#"+this.componentToHex(b)+this.componentToHex(d)+this.componentToHex(a)};e.prototype.componentToHex=function(b){b=b.toString(16);return 1==b.length?"0"+b:b};e.prototype.hexToRgb=function(b){b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return this.rgb(parseInt(b[1],16),parseInt(b[2],16),
parseInt(b[3],16))};e.prototype.alpha=function(){return this.rgba(0,0,0,0)};e.prototype.random=function(){var b=window.Math;return this.rgb(b.round(255*b.random()),b.round(255*b.random()),b.round(255*b.random()))};e.prototype.rgbStringToObject=function(b){var d={};b&&(b=b.match(/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/))&&(d.r=parseInt(b[1]),d.g=parseInt(b[2]),d.b=parseInt(b[3]));return d};g.color=new e})(window.Match);(function(g){function e(){this.math=window.Math}e.prototype.integer=function(b,d){return this.math.floor(this.math.random()*(d-b+1))+b};e.prototype.decimal=function(b,d){return this.math.random()*(d-b)+b};e.prototype.bool=function(){return 0.5>this.math.random()};e.prototype.sign=function(){return this.bool()?1:-1};e.prototype.booleanFromChance=function(b){return this.integer(0,100)<=b};e.prototype.color=function(){return g.color.random()};g.random=new e})(window.Match);(function(g){function e(){}g.postProcess||(g.postProcess={});e.prototype.run=function(b){return b.canvas};g.postProcess.NoPostProcess=e})(window.M);(function(g){function e(){}g.postProcess||(g.postProcess={});e.prototype.run=function(b){var d=b.getImageData(0,0,b.canvas.width,b.canvas.height),a=d.data,h=a.length,f,e,g,q;for(f=0;f<h;f+=4)e=a[f],g=a[f+1],q=a[f+2],e=0.2126*e+0.7152*g+0.0722*q,a[f]=a[f+1]=a[f+2]=e;b.putImageData(d,0,0);return b.canvas};g.postProcess.GrayScale=e})(window.M);
(function(g){function e(b){if(void 0==b)throw Error("Brightness has no constructor that takes no arguments. You must specify the brightness value");this.value=b}g.postProcess||(g.postProcess={});e.prototype.run=function(b){for(var d=b.getImageData(0,0,b.canvas.width,b.canvas.height),a=d.data,h=0;h<a.length;h+=4)a[h]+=this.value,a[h+1]+=this.value,a[h+2]+=this.value;b.putImageData(d,0,0);return b.canvas};g.postProcess.Brightness=e})(window.M);
(function(g){function e(b,d){this.matrix=b;this.opaque=d}g.postProcess||(g.postProcess={});e.prototype.setSharpen=function(){this.matrix=[0,-1,0,-1,5,-1,0,-1,0]};e.prototype.setBlur=function(){this.matrix=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9]};e.prototype.setContour=function(){this.matrix=[1,1,1,1,0.7,-1,-1,-1,-1]};e.prototype.run=function(b){if(this.matrix){var d=Math.round(Math.sqrt(this.matrix.length)),a=Math.floor(d/2),h=b.getImageData(0,0,b.canvas.width,b.canvas.height),f=h.data,e=h.width,g=
h.height,q=document.createElement("canvas").getContext("2d");q.canvas.width=h.width;q.canvas.height=h.height;for(var h=q.getImageData(0,0,h.width,h.height),q=h.data,p=this.opaque?1:0,n=0;n<g;n++)for(var r=0;r<e;r++){for(var s=n,t=r,u=4*(n*e+r),D=0,E=0,F=0,A=0,B=0;B<d;B++)for(var C=0;C<d;C++){var w=s+B-a,z=t+C-a;0<=w&&(w<g&&0<=z&&z<e)&&(w=4*(w*e+z),z=this.matrix[B*d+C],D+=f[w]*z,E+=f[w+1]*z,F+=f[w+2]*z,A+=f[w+3]*z)}q[u]=D;q[u+1]=E;q[u+2]=F;q[u+3]=A+p*(255-A)}b.putImageData(h,0,0);return b.canvas}};
g.postProcess.Convolute=e})(window.M);(function(g){function e(){this.postProcessing=new g.postProcess.NoPostProcess;this.buffer=document.createElement("canvas").getContext("2d");this.onRenderList=[];this.eventListener={needsRedraw:!0,needsSorting:!1};this.operation=this.scale=this.rotation=null;this.parrallaxFactor={x:1,y:1};this._onLoopAnimations=[];g.frontBuffer&&this.setSize(g.frontBuffer.canvas.width,g.frontBuffer.canvas.height)}e.prototype={_loopThroughAnimations:function(){for(var b=0,d=this._onLoopAnimations.length;b<d;b++)this._onLoopAnimations[b].onLoop()||
this._onLoopAnimations.splice(b,1)},setAlpha:function(b){this._alpha=b},getAlpha:function(){return this._alpha},fadeIn:function(b,d){this._onLoopAnimations.push(new g.effects.visual.FadeIn(this,b,d));return this},fadeOut:function(b,d){this._onLoopAnimations.push(new g.effects.visual.FadeOut(this,b,d));return this},continousFade:function(b,d,a,h){this._onLoopAnimations.push(new g.effects.visual.ContinousFade(this,b,d,a,h));return this},setBufferSize:function(b){if(!(b instanceof HTMLCanvasElement))throw Error("setBufferSize is expecting an HTMLCanvasElement as argument");
this.buffer.canvas.width=b.width;this.buffer.canvas.height=b.height},setAntialiasing:function(b){this.buffer.mozImageSmoothingEnabled=b;this.buffer.webkitImageSmoothingEnabled=b;this.buffer.mozImageSmoothingEnabled=b;this.buffer.webkitImageSmoothingEnabled=b},getWidth:function(){return this.buffer.canvas.width},getHeight:function(){return this.buffer.canvas.height},setWidth:function(b){this.buffer.canvas.width=b},setHeight:function(b){this.buffer.canvas.height=b},setSize:function(b,d){this.setWidth(b);
this.setHeight(d)},getCenter:function(){return new g.math2d.Vector2d(this.buffer.canvas.width/2,this.buffer.canvas.height/2)},onLoop:function(b){var d=b.camera.x*this.parrallaxFactor.x,a=b.camera.y*this.parrallaxFactor.y,h=d+b.camera.viewportWidth;b=a+b.camera.viewportHeight;var f=this.buffer,e=f.canvas;this.eventListener.needsRedraw&&(this.clearColor?(f.fillStyle=this.clearColor,f.fillRect(0,0,e.width,e.height)):f.clearRect(0,0,e.width,e.height),this.renderGameObjects(this.onRenderList,f,e,d,a,h,
b),this.eventListener.needsRedraw=!1,this.result=this.postProcessing.run(f));this.eventListener.needsSorting&&(this.sort(),this.eventListener.needsSorting=!1);this._loopThroughAnimations();return this.result},renderGameObjects:function(b,d,a,h,f,e,g){for(var q in b){var p=b[q];p.isVisible(h,f,e,g)&&(p.onRender(d,a,h,f,e,g),p.children&&this.renderGameObjects(p.children,d,a,h,f,e,g))}},addToGame:function(){g.pushGameLayer(this)},push:function(b,d,a){if(!b)throw Error("Cannot add null object to rendering loop");
b instanceof Function&&(b={onRender:b,isVisible:function(){return this.onChangeEvent.needsRedraw=!0},setZIndex:function(a){this._zIndex=a}});if(b.onRender){d&&(b.key=d);if(void 0==b._zIndex){if(-1<a)try{b.setZIndex(a||0)}catch(e){b._zIndex=a||0}}else b.setZIndex(b.getZIndex());if(b.onLoad)b.onLoad();this.eventListener.needsSorting=!0;b.onChangeEvent=this.eventListener;this.onRenderList.push(b);b.onLoop&&g.pushGameObject(b);d=g.camera;a=d.x*this.parrallaxFactor.x;var f=d.y*this.parrallaxFactor.y;b.isVisible(a,
f,a+d.viewportWidth,f+d.viewportHeight)&&(this.eventListener.needsRedraw=!0)}else console.warn("Cannot add object with no onRender method ",b.constructor.name,"adding to Match list of Game Objects"),g.pushGameObject(b)},sort:function(){this.onRenderList.sort(this._sortFunction)},_sortFunction:function(b,d){return b._zIndex-d._zIndex},getFirst:function(){return this.getIndex(0)},getIndex:function(b){try{return this.onRenderList[b]}catch(d){return null}},getAsBase64Image:function(){return this.buffer.canvas.toDataURL()},
getAsImage:function(){var b=new Image;b.src=this.getAsBase64Image();return b},get:function(b){if(this.cache&&this.cache.key==b)return this.cache;for(var d=this.onRenderList.length,a;d--;)if(a=this.onRenderList[d],b==a.key)return this.cache=a;return null},getLast:function(){return this.getIndex(this.onRenderList.length-1)},isOnRenderList:function(b){return-1!=this.onRenderList.indexOf(b)},remove:function(b){if(void 0!=b){if("string"==typeof b)this.remove(this.get(b));else if(isNaN(b)){var d=this.onRenderList.indexOf(b);
-1!=d&&this.onRenderList.splice(d,1)}else this.onRenderList.splice(b,1);b.onLoop&&g.removeGameObject(b);this._needsRedraw=!0}},removeAll:function(){this.onRenderList=[]},setBackground:function(b){this.buffer.canvas.style.setProperty("background",b,null)},getBackground:function(){return this.buffer.canvas.getPropertyValue("background")}};g.GameLayer=g.Layer=e})(window.Match);(function(g,e){function b(){this.def="easeOutQuad";this.math=window.Math}function d(a,b,d,f,e){this.angle=0;this._rotationSpeed=0.1;this.speed=0.05;this.vanishRate=0.0050;this.alpha=1;this.setPath(a,b);this.setWidth(d);this.setHeight(f);this.onChangeEvent={}}function a(a,b,d,f,e,h,g,m,k){this.minAngle||(this.minAngle=0);this.maxAngle||(this.maxAngle=6.28);this.amount=a;this.color=b;this.minWidth=d||1;this.minHeight=f||1;this.maxWidth=e||3;this.maxHeight=h||3;this.minSpeed=g||0.01;this.maxSpeed=m||
0.1;this.vanishRate=k;this.onChangeEvent={}}function h(a,b,f,h,g,m,k,q,n){this.origin=origin;this.direction=direction;a=particleAmount;var p=origin,r=direction;f=f||4;h=h||4;g=g||8;m=m||8;k=k||0.01;q=q||0.4;n=n||e.Math2d.randomFloat(0.01,0.03);for(var s=e.Math2d,t=[],u=0;u<a;u++){var v=new d(p,{x:p.x+5*r.x,y:p.y+5*r.y});v.setWidth(s.randomInt(f,g));v.setHeight(s.randomInt(h,m));if(b)v.color=b[s.randomInt(0,b.length-1)];else switch(s.randomInt(0,2)){case 0:v.color="rgb(255, 128, 0)";break;case 1:v.color=
"rgb(255, 180, 0)";break;case 2:v.color="rgb(255, 80, 0)"}n&&(v.vanishRate=n);v.speed=s.randomFloat(k,q);t.push(v)}this.particles=t;this.visibleParticles=this.particles.length}function f(a){this.operation="source-atop";this.startTime=0;e.applyProperties(this,a,["fillStyle"])}function m(a,b,d){void 0==b&&(b=1);this.rate=1/(b*e.getAverageFps());this.object=a;this.onFinished=d}function k(a,b,d){void 0==b&&(b=1);this.rate=1/(b*e.getAverageFps());this.object=a;this.onFinished=d}function q(a,b,d){void 0==
b&&(b=1);this.seconds=b;this.object=a;this.timer=0;this.onFinished=d}function p(a,b,d,f,h){void 0==b&&(b=1);this.rate=1/(b*e.getAverageFps());this.object=a;this.min=f||0;this.max=h||1;a.setAlpha(1);this.onFinished=this.changeFade;this.onLoop=d?this.fadeOut:this.fadeIn}function n(a,b,d,f,h){this.object=a;this._x=b;this._y=d;void 0==f&&(f=1);this.onFinished=h;h=e.Math2d;f*=e.getAverageFps();a=new h.Vector2d(a._x,a._y);b=new h.Vector2d(b,d);this.speed=h.getDistance(a,b)/f;this.direction=e.Math2d.getNormalized(e.Math2d.getVector2d(a,
b))}function r(a,b,d,f,h){f*=e.getAverageFps();a._scale||(a._scale={x:1,y:1});this.speedX=Math.abs(a._scale.x-b)/f;this.speedY=Math.abs(a._scale.y-d)/f;this.object=a;this._x=b;this._y=d;this.onFinished=h}function s(a,b,d,f,h){f*=e.getAverageFps();a._scale||(a._scale={x:1,y:1});this.speedX=Math.abs(a._scale.x-b)/f;this.speedY=Math.abs(a._scale.y-d)/f;this.object=a;this._x=b;this._y=d;this.onFinished=h}function t(a,b,d,f){this.object=a;this.times=void 0==b?6:2*b;this.duration=void 0==d?250:d;this.lastTime=
0;this.onFinished=f}function u(a,b,d,f){d||(d=1);this.frames=d*e.getAverageFps();a._rotation||(a._rotation=0);this.object=a;this.angle=b;this.onFinished=f;this._rotation=(this.angle-a._rotation)/this.frames}b.prototype.swing=function(a,b,d,f,h){return this[this.def](a,b,d,f,h)};b.prototype.easeInQuad=function(a,b,d,f,h){return f*(b/=h)*b+d};b.prototype.easeOutQuad=function(a,b,d,f,h){return-f*(b/=h)*(b-2)+d};b.prototype.easeInOutQuad=function(a,b,d,f,h){return 1>(b/=h/2)?f/2*b*b+d:-f/2*(--b*(b-2)-
1)+d};b.prototype.easeInCubic=function(a,b,d,f,h){return f*(b/=h)*b*b+d};b.prototype.easeOutCubic=function(a,b,d,f,h){return f*((b=b/h-1)*b*b+1)+d};b.prototype.easeInOutCubic=function(a,b,d,f,h){return 1>(b/=h/2)?f/2*b*b*b+d:f/2*((b-=2)*b*b+2)+d};b.prototype.easeInQuart=function(a,b,d,f,h){return f*(b/=h)*b*b*b+d};b.prototype.easeOutQuart=function(a,b,d,f,h){return-f*((b=b/h-1)*b*b*b-1)+d};b.prototype.easeInOutQuart=function(a,b,d,f,h){return 1>(b/=h/2)?f/2*b*b*b*b+d:-f/2*((b-=2)*b*b*b-2)+d};b.prototype.easeInQuint=
function(a,b,d,f,h){return f*(b/=h)*b*b*b*b+d};b.prototype.easeOutQuint=function(a,b,d,f,h){return f*((b=b/h-1)*b*b*b*b+1)+d};b.prototype.easeInOutQuint=function(a,b,d,f,h){return 1>(b/=h/2)?f/2*b*b*b*b*b+d:f/2*((b-=2)*b*b*b*b+2)+d};b.prototype.easeInSine=function(a,b,d,f,h){return-f*this.math.cos(b/h*(this.math.PI/2))+f+d};b.prototype.easeOutSine=function(a,b,d,f,h){return f*this.math.sin(b/h*(this.math.PI/2))+d};b.prototype.easeInOutSine=function(a,b,d,f,h){return-f/2*(this.math.cos(this.math.PI*
b/h)-1)+d};b.prototype.easeInExpo=function(a,b,d,f,h){return 0==b?d:f*this.math.pow(2,10*(b/h-1))+d};b.prototype.easeOutExpo=function(a,b,d,f,h){return b==h?d+f:f*(-this.math.pow(2,-10*b/h)+1)+d};b.prototype.easeInOutExpo=function(a,b,d,f,h){return 0==b?d:b==h?d+f:1>(b/=h/2)?f/2*this.math.pow(2,10*(b-1))+d:f/2*(-this.math.pow(2,-10*--b)+2)+d};b.prototype.easeInCirc=function(a,b,d,f,h){return-f*(this.math.sqrt(1-(b/=h)*b)-1)+d};b.prototype.easeOutCirc=function(a,b,d,f,h){return f*this.math.sqrt(1-
(b=b/h-1)*b)+d};b.prototype.easeInOutCirc=function(a,b,d,f,h){return 1>(b/=h/2)?-f/2*(this.math.sqrt(1-b*b)-1)+d:f/2*(this.math.sqrt(1-(b-=2)*b)+1)+d};b.prototype.easeInElastic=function(a,b,d,f,h){a=1.70158;var e=0,g=f;if(0==b)return d;if(1==(b/=h))return d+f;e||(e=0.3*h);g<this.math.abs(f)?(g=f,a=e/4):a=e/(2*this.math.PI)*this.math.asin(f/g);return-(g*this.math.pow(2,10*(b-=1))*this.math.sin((b*h-a)*2*this.math.PI/e))+d};b.prototype.easeOutElastic=function(a,b,d,f,h){a=1.70158;var e=0,g=f;if(0==
b)return d;if(1==(b/=h))return d+f;e||(e=0.3*h);g<this.math.abs(f)?(g=f,a=e/4):a=e/(2*this.math.PI)*this.math.asin(f/g);return g*this.math.pow(2,-10*b)*this.math.sin((b*h-a)*2*this.math.PI/e)+f+d};b.prototype.easeInOutElastic=function(a,b,d,f,h){a=1.70158;var e=0,g=f;if(0==b)return d;if(2==(b/=h/2))return d+f;e||(e=h*0.3*1.5);g<this.math.abs(f)?(g=f,a=e/4):a=e/(2*this.math.PI)*this.math.asin(f/g);return 1>b?-0.5*g*this.math.pow(2,10*(b-=1))*this.math.sin((b*h-a)*2*this.math.PI/e)+d:0.5*g*this.math.pow(2,
-10*(b-=1))*this.math.sin((b*h-a)*2*this.math.PI/e)+f+d};b.prototype.easeInBack=function(a,b,d,f,h,e){void 0==e&&(e=1.70158);return f*(b/=h)*b*((e+1)*b-e)+d};b.prototype.easeOutBack=function(a,b,d,f,h,e){void 0==e&&(e=1.70158);return f*((b=b/h-1)*b*((e+1)*b+e)+1)+d};b.prototype.easeInOutBack=function(a,b,d,f,h,e){void 0==e&&(e=1.70158);return 1>(b/=h/2)?f/2*b*b*(((e*=1.525)+1)*b-e)+d:f/2*((b-=2)*b*(((e*=1.525)+1)*b+e)+2)+d};b.prototype.easeInBounce=function(a,b,d,f,h){return f-this.easeOutBounce(a,
h-b,0,f,h)+d};b.prototype.easeOutBounce=function(a,b,d,f,h){return(b/=h)<1/2.75?f*7.5625*b*b+d:b<2/2.75?f*(7.5625*(b-=1.5/2.75)*b+0.75)+d:b<2.5/2.75?f*(7.5625*(b-=2.25/2.75)*b+0.9375)+d:f*(7.5625*(b-=2.625/2.75)*b+0.984375)+d};b.prototype.easeInOutBounce=function(a,b,d,f,h){return b<h/2?0.5*this.easeInBounce(a,2*b,0,f,h)+d:0.5*this.easeOutBounce(a,2*b-h,0,f,h)+0.5*f+d};d.prototype.setWidth=function(a){this._halfWidth=a/2};d.prototype.setHeight=function(a){this._halfHeight=a/2};d.prototype.setPath=
function(a,b){this._x=a.x;this._y=a.y;this.direction=e.math2d.getVector2d(a,b)};d.prototype.onLoop=function(){this.alpha-=this.vanishRate;this.angle+=this._rotationSpeed;this._x+=this.speed*this.direction.x;this._y+=this.speed*this.direction.y;this.onChangeEvent.needsRedraw=!0};d.prototype.onRender=function(a,b,d,f){0<=this.alpha&&(a.save(),a.globalAlpha=this.alpha,a.translate(this._x-d,this._y-f),a.rotate(this.angle),a.fillStyle=this.fillStyle,a.fillRect(-this._halfWidth,-this._halfHeight,this._halfWidth,
this._halfHeight),a.restore())};d.prototype.setZIndex=function(a){this._zIndex=a;this.onChangeEvent.needsRedraw=!0;this.onChangeEvent.needsSorting=!0};d.prototype.isVisible=function(a,b,d,f){return 0>=this.alpha||this._y+this._halfHeight<b||this._y-this._halfHeight>f||this._x+this._halfWidth<a||this._x-this._halfWidth>d?!1:!0};a.prototype.onLoop=function(){if(this.children){for(var a=0,b=this.children.length,d=0,f;a<b;a++)if(f=this.children[a],0>=f.alpha)d++;else f.onLoop();d==b?this.children=null:
this.onChangeEvent.needsRedraw=!0}};a.prototype.onRender=function(){};a.prototype.isVisible=function(){return!0};a.prototype.setZIndex=function(a){this._zIndex=a;this.onChangeEvent.needsRedraw=!0;this.onChangeEvent.needsSorting=!0};a.prototype.create=function(a,b){var f=e.random;this.children=[];for(var h=0;h<this.amount;h++){var g=f.decimal(this.minAngle,this.maxAngle),m={},k={};m.x=a;m.y=b;k.x=a+50*Math.cos(g);k.y=b+50*Math.sin(g);g=new d(m,k);g.setWidth(f.integer(this.minWidth,this.maxWidth));
g.setHeight(f.integer(this.minHeight,this.maxHeight));if(this.color)g.fillStyle=this.color[f.integer(0,color.length-1)];else switch(f.integer(0,2)){case 0:g.fillStyle="rgb(255, 128, 0)";break;case 1:g.fillStyle="rgb(255, 180, 0)";break;default:g.fillStyle="rgb(255, 80, 0)"}this.vanishRate&&(g.vanishRate=this.vanishRate);g.speed=f.decimal(this.minSpeed,this.maxSpeed);this.children.push(g)}};h.prototype.create=function(a,b){};h.prototype.onLoop=function(a){if(this.visible){for(var b,d=0;d<this.particles.length;d++)b=
this.particles[d],b.onLoop(a),b.isVisible()||(this.loop?(b.setPath(this.origin,{x:this.origin.x+5*this.direction.x,y:this.origin.y+5*this.direction.y}),b.rotation=0,b.alpha=1,b.angle=0,b.vanishRate=e.Math2d.randomFloat(0.05,0.2),b.speed=e.Math2d.randomFloat(0.0050,0.5)):this.visibleParticles--);1>this.visibleParticles&&e.remove(this)}};f.prototype={render:function(a,b,d){this.isVisible()&&(a.globalCompositeOperation=this.operation,a.fillStyle=this.fillStyle,a.fillRect(0,0,b,d))},show:function(){this.startTime=
e.getTimeInMillis()},isVisible:function(){return this.showAlways||e.getTimeInMillis()-this.startTime<this.duration}};m.prototype.initialize=function(){this.object.setAlpha(0);this.onLoop=this.run;return!0};m.prototype.run=function(){var a=this.object.getAlpha()+this.rate;if(1>a)this.object.setAlpha(a);else return this.object.setAlpha(1),this.onFinished&&this.onFinished.apply(this.object),!1;return!0};m.prototype.onLoop=m.prototype.initialize;k.prototype.initialize=function(){this.object.setAlpha(1);
this.onLoop=this.run;return!0};k.prototype.run=function(){var a=this.object.getAlpha()-this.rate;if(0<a)this.object.setAlpha(a);else return this.object.setAlpha(0),this.onFinished&&this.onFinished.apply(this.object),!1;return!0};k.prototype.onLoop=k.prototype.initialize;q.prototype.initialize=function(a){this.timer=new e.TimeCounter(1E3*this.seconds);this.onLoop=this.run};q.prototype.run=function(){return this.timer.elapsed()?(this.onFinished&&this.onFinished.apply(this.object),!1):!0};q.prototype.onLoop=
q.prototype.initialize;p.prototype.fadeIn=function(a){a=this.object._alpha+this.rate;a<this.max?this.object.setAlpha(a):(this.object.setAlpha(this.max),this.onLoop=this.fadeOut);return!0};p.prototype.fadeOut=function(){var a=this.object._alpha-this.rate;a>this.min?this.object.setAlpha(a):(this.object.setAlpha(this.min),this.onLoop=this.fadeIn);return!0};n.prototype={onLoop:function(a){a=1<Math.abs(this._x-this.object._x);var b=1<Math.abs(this._y-this.object._y);a&&this.object.offsetX(this.direction.x*
this.speed);b&&this.object.offsetY(this.direction.y*this.speed);return a||b?!0:(this.onFinished&&this.onFinished.apply(this.object),!1)}};r.prototype={onLoop:function(a){this.object._scale.x<this._x&&(this.object._scale.x+=this.speedX,this.object.onChangeEvent.needsRedraw=!0);this.object._scale.y<this._y&&(this.object._scale.y+=this.speedY,this.object.onChangeEvent.needsRedraw=!0);return this.object._scale.x>=this._x&&this.object._scale.y>=this._y?(this.onFinished&&this.onFinished.apply(this.object),
!1):!0}};s.prototype={onLoop:function(a){this.object._scale.x>this._x&&(this.object._scale.x-=this.speedX,this.object.onChangeEvent.needsRedraw=!0);this.object._scale.y>this._y&&(this.object._scale.y-=this.speedY,this.object.onChangeEvent.needsRedraw=!0);return this.object._scale.x<=this._x&&this.object._scale.y<=this._y?(this.onFinished&&this.onFinished.apply(this.object),!1):!0}};t.prototype={onLoop:function(a){if(e.getTimeInMillis()-this.lastTime>=this.duration){if(this.times--)1==this.object._alpha?
this.object.setAlpha(0):this.object.setAlpha(1);else return this.object.setAlpha(void 0),this.onFinished&&this.onFinished.apply(this.object),!1;this.lastTime=e.getTimeInMillis()}return!0}};u.prototype={onLoop:function(a){if(this.frames--)this.object.offsetRotation(this._rotation);else return this.onFinished&&this.onFinished.apply(this.object),!1;return!0}};g.visual={Particle:d,LinearParticleEmitter:h,RadialParticleEmitter:a,Tint:f,Move:n,FadeIn:m,FadeOut:k,ContinousFade:p,ScaleUp:r,ScaleDown:s,Rotate:u,
Twinkle:t,Wait:q}})(M.effects||(M.effects={}),M);(function(g){function e(b,d,a){this.interval=b;this._lastTime=g.getTime();a?(this.owner=a,this.callback=d):this.tick=d;this.enabled=!0}e.prototype.onLoop=function(b){this.enabled&&g.elapsedTimeFrom(this._lastTime,this.interval)&&(this.tick(),this._lastTime=g.getTime())};e.prototype.tick=function(){this.callback.call(this.owner)};g.Timer=e})(window.Match);(function(g){function e(b){this._lastTime=0;this.time=b;this._initialized=!1}e.prototype.elapsed=function(){var b=g.getTime();return this._initialized?b-this.time>=this._lastTime?(this._lastTime=b,!0):!1:(this._lastTime=b,this._initialized=!0,!1)};g.TimeCounter=e})(window.Match);(function(g,e){function b(){this.path="";this.total=this.toLoad=0;this.onImageLoaded=new e;this.onAllImagesLoaded=new e;this.onImageError=new e}function d(){g.sprites._imageError(this)}function a(){g.sprites._imageLoaded(this)}b.prototype._imageLoaded=function(a){this.toLoad--;if(a.frames)if(a.frames instanceof Array)for(var b in a.frames)a.frames[b].halfWidth=a.frames[b].width/2,a.frames[b].halfHeight=a.frames[b].height/2;else{b=[];var d=a.frames.width,e=a.frames.height,g=a.frames.padding||0,p=Math.floor(a.width/
(d+g)),n=Math.floor(a.height/(e+g)),r,s;for(s=0;s<n;s++)for(r=0;r<p;r++)b.push({x:(g+d)*r+g,y:(g+e)*s+g,width:d,height:e,halfWidth:d/2,halfHeight:e/2});a.frames=b}else a.frames=[{x:0,y:0,width:a.width,height:a.height,halfWidth:a.width/2,halfHeight:a.height/2}];this.onImageLoaded.raise({image:a,name:a.getAttribute("data-name"),remaining:this.toLoad,total:this.total});0>=this.toLoad&&this.onAllImagesLoaded.raise()};b.prototype._imageError=function(a){this.toLoad--;this.onImageError.raise(a);console.error("Could not load",
a.src)};b.prototype.load=function(b){var f,e,g;b.onProgress&&(this.onImageLoaded.addEventListener(b.onProgress),b.onProgress=null);b.onFinish&&(this.onAllImagesLoaded.addEventListener(b.onFinish),b.onFinish=null);for(g in b)f=b[g],e=new Image,e.setAttribute("data-name",g),e.onload=a,e.onerror=d,this.total=++this.toLoad,"string"==typeof f?e.src=this.path+f:(e.src=this.path+f.source,e.frames=f.frames,e.animations=f.animations),this[g]=e};b.prototype.remove=function(a){this[a]instanceof Image&&(delete this[a],
0<=this.total-1&&this.total--,0<=this.toLoad-1&&this.toLoad--)};b.prototype.removeAll=function(){for(var a in this)this.remove(a)};b.prototype.removeAllEventListeners=function(){this.onImageLoaded=new e;this.onAllImagesLoaded=new e;this.onImageError=new e};g.SpriteManager=new b;g.sprites=g.SpriteManager})(M||(M={}),M.EventListener||(M.EventListener={}));(function(g){function e(){g.sounds[this.name].setReady();g.sounds.toLoad--;0>=g.sounds.toLoad&&g.sounds.onAllSoundsLoaded.raise()}function b(){console.warn("Unable to load "+this.src);g.sounds.error=!0;g.sounds[this.name].setNotReady();g.sounds.toLoad--;0>=g.sounds.toLoad&&g.sounds.onAllSoundsLoaded.raise()}function d(a,b){this.audioBuffer=[];this.src=b;this.name=a;this.increaseBuffer()}function a(){this.total=this.toLoad=0;this.onSoundLoaded=new g.EventListener;this.onAllSoundsLoaded=new g.EventListener;
this.onSoundError=new g.EventListener;this.error=!1}d.prototype.MAX_BUFFER=3;d.prototype.setReady=function(){this.canPlay=this.checkOk;1==this.audioBuffer.length&&g.sounds.onSoundLoaded.raise({sound:this,remaining:g.sounds.toLoad,total:g.sounds.total})};d.prototype.setNotReady=function(){this.canPlay=this.checkOk;g.sounds.onSoundError.raise({sound:this,remaining:g.sounds.toLoad,total:g.sounds.total})};d.prototype.play=function(){if(this.canPlay()){for(var a=0,b;a<this.audioBuffer.length;){b=this.audioBuffer[a];
if(b.ended||0==b.currentTime){b.play();return}a++}b=this.audioBuffer[0];b.pause();b.currentTime=0;b.play();this.audioBuffer.length<this.MAX_BUFFER&&this.increaseBuffer()}};d.prototype.stop=function(){this.canPlay()&&this.each(function(a){0<a.duration&&(a.pause(),a.currentTime=0)})};d.prototype.pause=function(){this.canPlay()&&(this.onNextPauseResume?(this.play(),this.onNextPauseResume=!1):(this.onNextPauseResume=this.isPlaying(),this.each(function(a){a.pause()})))};d.prototype.checkFail=function(){return!1};
d.prototype.checkOk=function(){return!0};d.prototype.canPlay=function(){this.increaseBuffer();return!1};d.prototype.setPlaybackRate=function(a){this.each(function(b){b.playbackRate=a})};d.prototype.resetPlaybackRate=function(){this.each(function(a){a.playbackRate=1})};d.prototype.getPlaybackRate=function(){return this.audioBuffer[0].playbackRate};d.prototype.isPaused=function(){var a=0;for(l=this.audioBuffer.length;a<l;a++)if(this.audioBuffer[a].paused)return!0;return!1};d.prototype.setVolume=function(a){this.each(function(b){b.volume=
a})};d.prototype.isPlaying=function(){var a=0;for(l=this.audioBuffer.length;a<l;a++)if(!this.audioBuffer[a].paused)return!0;return!1};d.prototype.each=function(a){for(var b=this.audioBuffer.length;b--;)a(this.audioBuffer[b])};d.prototype.increaseBuffer=function(){var a=new Audio(this.src),d=this.audioBuffer[0];a.addEventListener("loadeddata",e);a.addEventListener("error",b);a.name=this.name;d&&(a.muted=d.muted,a.volume=d.volume);this.audioBuffer.push(a)};d.prototype.mute=function(){this.each(function(a){a.muted=
!a.muted})};d.prototype.setLoop=function(a){this.audioBuffer[0].loop=a};var h=function(){};fakeSound={name:""};for(var f in d.prototype)"function"==typeof d.prototype[f]&&(fakeSound[f]=h);a.prototype.load=function(){if(1<arguments.length)this.loadOne(arguments[0],arguments[1]);else{var a=arguments[0];a.onProgress&&(this.onSoundLoaded.addEventListener(a.onProgress),a.onProgress=null);a.onFinish&&(this.onAllSoundsLoaded.addEventListener(a.onFinish),a.onFinish=null);for(var b in a)this.loadOne(b,a[b])}};
a.prototype.loadOne=function(a,b){this.total=++this.toLoad;void 0==g.browser.supportedAudioFormat?(this[a]=fakeSound,fakeSound.name=a,this.onSoundLoaded.raise({sound:fakeSound,remaining:g.sounds.toLoad--,total:g.sounds.total}),0>=this.toLoad&&this.onAllSoundsLoaded.raise()):("."!=b.charAt(b.length-4)&&(b+=g.browser.supportedAudioFormat),this[a]=new d(a,b));this[a].name=a};a.prototype.pause=function(){for(var a in this)this[a]instanceof d&&this[a].pause()};a.prototype.setVolume=function(a){for(var b in this)this[b]instanceof
d&&this[b].setVolume(a)};a.prototype.mute=function(){for(var a in this)this[a]instanceof d&&this[a].mute()};a.prototype.stop=function(){for(var a in this)this[a]instanceof d&&this[a].stop()};a.prototype.removeAll=function(){for(var a in this)delete this[a];this.audioBuffer=[];this.src=url;this.name=name;this.increaseBuffer()};g.SoundManager=g.sounds=new a})(window.Match);(function(g,e){function b(a){this._halfHeight=this._halfWidth=this._height=this._width=this._y=this._x=0;this._scale=this._rotation=null;this._visible=!0;this.operation=null;this._onLoopAnimations=[];this._chainAnimations=[];this._onLoopTimers=[];this._alpha=null;this.onChangeEvent={};this.set(a)}function d(a,b,d,e){this.width=d-a;this.height=e-b;this._x=a+this.width/2;this._y=b+this.height/2}b.prototype.removeChild=function(a){this.children[a]=null};b.prototype.putChild=function(a,b){this.children||
(this.children={});b.onChangeEvent=this.onChangeEvent;this.children[a]=b};b.prototype._zIndex=0;b.prototype.onLoop=function(a){this._loopThroughAnimations();this._loopThroughTimers();if(this.onUpdate)this.onUpdate(a)};b.prototype.set=function(a){if(a){var b="",d;for(d in a)if(b="set"+d.charAt(0).toUpperCase()+d.substr(1),this[b])this[b](a[d]);else this[d]=a[d]}};b.prototype.setAlpha=function(a){0<=a&&1>=a?(this._alpha=a,this.onChangeEvent.needsRedraw=!0):this._alpha=null};b.prototype.getAlpha=function(){return this._alpha};
b.prototype._loopThroughAnimations=function(){for(var a=0,b=this._onLoopAnimations.length;a<b;a++)this._onLoopAnimations[a].onLoop()||this._onLoopAnimations.splice(a,1);this._chainAnimations.length&&(this._chainAnimations[0].onLoop()||this._chainAnimations.splice(0,1))};b.prototype.fadeIn=function(a,b){this._onLoopAnimations.push(new e.FadeIn(this,a,b));return this};b.prototype.fadeOut=function(a,b){this._onLoopAnimations.push(new e.FadeOut(this,a,b));return this};b.prototype.continousFade=function(a,
b,d,g){this._onLoopAnimations.push(new e.ContinousFade(this,a,b,d,g));return this};b.prototype.move=function(a,b,d,g){this._onLoopAnimations.push(new e.Move(this,a,b,d,g));return this};b.prototype.scaleUp=function(a,b,d,g){this._onLoopAnimations.push(new e.ScaleUp(this,a,b,d,g));return this};b.prototype.scaleDown=function(a,b,d,g){this._onLoopAnimations.push(new e.ScaleDown(this,a,b,d,g));return this};b.prototype.twinkle=function(a,b,d){this._onLoopAnimations.push(new e.Twinkle(this,a,b,d));return this};
b.prototype.rotate=function(a,b,d){this._onLoopAnimations.push(new e.Rotate(this,a,b,d));return this};b.prototype.chainWait=function(a,b){this._chainAnimations.push(new e.Wait(this,a,b));return this};b.prototype.chainFadeIn=function(a,b){this._chainAnimations.push(new e.FadeIn(this,a,b));return this};b.prototype.chainFadeOut=function(a,b){this._chainAnimations.push(new e.FadeOut(this,a,b));return this};b.prototype.chainContinousFade=function(a,b,d,g){this._chainAnimations.push(new e.ContinousFade(this,
a,b,d,g));return this};b.prototype.chainMove=function(a,b,d,g){this._chainAnimations.push(new e.Move(this,a,b,d,g));return this};b.prototype.chainScaleUp=function(a,b,d,g){this._chainAnimations.push(new e.ScaleUp(this,a,b,d,g));return this};b.prototype.chainScaleDown=function(a,b,d,g){this._chainAnimations.push(new e.ScaleDown(this,a,b,d,g));return this};b.prototype.chainTwinkle=function(a,b,d){this._chainAnimations.push(new e.Twinkle(this,a,b,d));return this};b.prototype.chainRotate=function(a,b,
d){this._chainAnimations.push(new e.Rotate(this,a,b,d));return this};b.prototype._loopThroughTimers=function(){for(var a=0,b=this._onLoopTimers.length;a<b;a++)this._onLoopTimers[a].onLoop()};b.prototype.addTimer=function(a,b){var d=new g.Timer(a,b,this);this._onLoopTimers.push(d);return d};b.prototype.removeTimer=function(a){this._onLoopTimers.splice(this._onLoopTimers.indexOf(this._getTimer(a)),1);return this};b.prototype._getTimer=function(a){for(var b=0,d=this._onLoopTimers.length;b<d;b++)if(this._onLoopTimers[b].callback==
a)return this._onLoopTimers[b]};b.prototype.setZIndex=function(a){this._zIndex=a;this.onChangeEvent.needsRedraw=!0;this.onChangeEvent.needsSorting=!0};b.prototype.getZIndex=function(){return this._zIndex};b.prototype.setVisible=function(a){this._visible=a;this.onChangeEvent.needsRedraw=!0};b.prototype.setWidth=function(a){this._width=a;this._halfWidth=a/2;this.onChangeEvent.needsRedraw=!0};b.prototype.setHeight=function(a){this._height=a;this._halfHeight=a/2;this.onChangeEvent.needsRedraw=!0};b.prototype.getWidth=
function(){return this._scale?this._width*this._scale.x:this._width};b.prototype.getHeight=function(){return this._scale?this._height*this._scale.y:this._height};b.prototype.setSize=function(a,b){this.setWidth(a);this.setHeight(b)};b.prototype.getSize=function(){return{width:this.getWidth(),height:this.getHeight()}};b.prototype.setScale=function(a,b){if(a||b)a||(a=1),b||(b=1),this._scale={x:a,y:b},this.onChangeEvent.needsRedraw=!0};b.prototype.setScaleX=function(a){this._scale||(this._scale={},this._scale.y=
1);this._scale.x=a;this.onChangeEvent.needsRedraw=!0};b.prototype.setScaleY=function(a){this._scale||(this._scale={},this._scale.x=1);this._scale.y=a;this.onChangeEvent.needsRedraw=!0};b.prototype.mirror=function(){this.invertX()};b.prototype.invertX=function(){this._scale||(this._scale={},this._scale.x=1,this._scale.y=1);this._scale.x*=-1;this.onChangeEvent.needsRedraw=!0};b.prototype.invertY=function(){this._scale||(this._scale={},this._scale.x=1,this._scale.y=1);this._scale.y=-1;this.onChangeEvent.needsRedraw=
!0};b.prototype.getLeft=function(){return this._scale?void 0!=this.pivotX?this._x+this.pivotX-this._width*this._scale.x:this._x-this._halfWidth*this._scale.x:void 0!=this.pivotX?this._x+this.pivotX-this._width:this._x-this._halfWidth};b.prototype.getRight=function(){return this._scale?void 0!=this.pivotX?this._x+this.pivotX+this._width*this._scale.x:this._x+this._halfWidth*this._scale.x:void 0!=this.pivotX?this._x+this.pivotX+this._width:this._x+this._halfWidth};b.prototype.getTop=function(){return this._scale?
void 0!=this.pivotY?this._y+this.pivotY-this._height*this._scale.y:this._y-this._halfHeight*this._scale.y:void 0!=this.pivotY?this._y+this.pivotY-this._height:this._y-this._halfHeight};b.prototype.getBottom=function(){return this._scale?void 0!=this.pivotY?this._y+this.pivotY+this._height*this._scale.y:this._y+this._halfHeight*this._scale.y:void 0!=this.pivotY?this._y+this.pivotY+this._height:this._y+this._halfHeight};b.prototype.setLeft=function(a){this._x=this._scale?a+this._halfWidth*this._scale.x:
a+this._halfWidth;this.onChangeEvent.needsRedraw=!0};b.prototype.setRight=function(a){this._x=this._scale?a-this._halfWidth*this._scale.x:a-this._halfWidth;this.onChangeEvent.needsRedraw=!0};b.prototype.setTop=function(a){this._y=this._scale?a+this._halfHeight*this._scale.y:a+this._halfHeight;this.onChangeEvent.needsRedraw=!0};b.prototype.setBottom=function(a){this._y=this._scale?a-this._halfHeight*this._scale.y:a-this._halfHeight;this.onChangeEvent.needsRedraw=!0};b.prototype.getLocation=function(){return{x:this._x,
y:this._y}};b.prototype.setLocation=function(a,b){this.prevX=this._x;this.prevY=this._y;this._x=a;this._y=b;this.onChangeEvent.needsRedraw=!0};b.prototype._applyOperation=function(a){this.operation?(a.globalCompositeOperation=this.operation,a.operationChanged=!1):a.operationChanged&&a.resetOperation()};b.prototype._applyAlpha=function(a){null!=this._alpha&&0<=this._alpha&&1>=this._alpha?(a.globalAlpha=this._alpha,a.alphaChanged=!1):a.alphaChanged&&a.resetAlpha()};b.prototype._applyShadow=function(a){this._shadow?
(a.shadowOffsetX=x,a.shadowOffsetY=y,a.shadowColor=color,a.shadowBlur=blur,a.shadowChanged=!1):a.shadowChanged&&a.resetShadow()};b.prototype._applyTranslation=function(a,b,d){a.translate(this._x-b,this._y-d)};b.prototype._applyRotation=function(a){this._rotation&&a.rotate(this._rotation)};b.prototype._applyScale=function(a){this._scale&&a.scale(this._scale.x,this._scale.y)};b.prototype.offsetAlpha=function(a){this._alpha+=a;this.onChangeEvent.needsRedraw=!0};b.prototype.offsetRotation=function(a){this._rotation+=
a;this.onChangeEvent.needsRedraw=!0};b.prototype.isVisible=function(a,b,d,e){return 0!=this._alpha&&this._visible?this.isIn(a,b,d,e):!1};b.prototype.isIn=function(a,b,f,e){return this._rotation?g.collisions.Polygon.haveCollided(this,new d(a,b,f,e)):this.getBottom()<b||this.getTop()>e||this.getRight()<a||this.getLeft()>f?!1:!0};b.prototype.setRotation=function(a){this._rotation=a;this.onChangeEvent.needsRedraw=!0};b.prototype.getRotation=function(){return this._rotation};b.prototype.setX=function(a){this.prevX=
this._x;this._x=a;this.onChangeEvent.needsRedraw=!0};b.prototype.setY=function(a){this.prevY=this._y;this._y=a;this.onChangeEvent.needsRedraw=!0};b.prototype.offset=function(a,b){this._x+=a;this._y+=b;this.onChangeEvent.needsRedraw=!0};b.prototype.offsetX=function(a){this._x+=a;this.onChangeEvent.needsRedraw=!0};b.prototype.offsetY=function(a){this._y+=a;this.onChangeEvent.needsRedraw=!0};b.prototype.centerAt=function(a){this.setLocation(a.x,a.y)};b.prototype.getX=function(){return this._x};b.prototype.getY=
function(){return this._y};b.prototype.onRender=function(){throw Error("Method onRender must be overriden");};b.prototype.getMaxSize=function(){return Math.max(this.getWidth(),this.getHeight())};g.renderers=g.renderers||{};g.renderers.Renderizable=b;d.prototype.getWidth=function(){return this.width};d.prototype.getHeight=function(){return this.height}})(window.M,window.M.effects.visual);(function(g,e,b){function d(a){b.apply(this);a&&this.setImage(a)}d.prototype.setImage=function(a,b){if(!a)throw Error("Image cannot be null");if(a instanceof Image)a.frames||(a.frames=[{x:0,y:0,width:a.width,height:a.height,halfWidth:a.width/2,halfHeight:a.height/2}]),this._image=a;else if(e.sprites[a])this._image=e.sprites[a];else throw Error("Image by id "+a+" not loaded");this.setFrameIndex(b)};d.prototype.play=function(a,b){if(!this._animation||this.animationName!=a||!this.isPlaying){if(a||!this._animation){if(!this._image)throw Error("No image selected");
if(!this._image.animations)throw Error("Image has no animations");if(!this._image.animations[a])throw Error("Image has no animation by name "+a);this._animation=this._image.animations[a];this.animationName=a;this._frameIndex=0}this.isPlaying=!0;this.loop=b;this.onChangeEvent.needsRedraw=!0}};d.prototype.stop=function(){this.isPlaying=!1};d.prototype._animate=function(){if(this.isPlaying){var a=e.getTime();this.currentFrameStartInMillis||(this.currentFrameStartInMillis=a);a-this.currentFrameStartInMillis>
this._animation.duration&&(this.currentFrame=this._image.frames[this._animation.frames[this._frameIndex]],this._frameIndex<this._animation.frames.length-1?this._frameIndex++:this.loop?this._frameIndex=0==this._frameIndex?1:0:this.isPlaying=!1,this.currentFrameStartInMillis=a,this.onChangeEvent.needsRedraw=!0)}};d.prototype.isLastAnimationFrame=function(){return this._animation?this._frameIndex==this._animation.frames.length-1:!1};d.prototype.isFirstAnimationFrame=function(){return this._animation?
1==this._frameIndex:!1};d.prototype.onLoop=function(a){this._loopThroughAnimations();this._loopThroughTimers();if(this.onUpdate)this.onUpdate(a);this._animate()};d.prototype.onRender=function(a,b,d,e){if(this._image){this._applyOperation(a);this._applyAlpha(a);var g;b=this.pivotX?this.pivotX:-this.oHW||-this.currentFrame.halfWidth;g=this.pivotY?this.pivotY:-this.oHH||-this.currentFrame.halfHeight;this._rotation||this._scale?(a.save(),this._applyTranslation(a,d,e),this._applyRotation(a),this._applyScale(a),
a.drawImage(this._image,this.currentFrame.x,this.currentFrame.y,this.currentFrame.width,this.currentFrame.height,b,g,this.oW||this.currentFrame.width,this.oH||this.currentFrame.height),a.restore()):a.drawImage(this._image,this.currentFrame.x,this.currentFrame.y,this.currentFrame.width,this.currentFrame.height,this._x+b,this._y+g,this.oW||this.currentFrame.width,this.oH||this.currentFrame.height);this._applyShadow(a)}};d.prototype.setSize=function(a,b){this.oW=a;this.oH=b;this.oHW=a/2;this.oHH=b/2;
this.onChangeEvent.needsRedraw=!0};d.prototype.setFrameIndex=function(a){this._frameIndex=a=a||0;this.currentFrame=this._image.frames[a]};d.prototype.getTop=function(){return this._scale?this._y-this.currentFrame.halfHeight*this._scale.y:this._y-this.currentFrame.halfHeight};d.prototype.getBottom=function(){return this._scale?this._y+this.currentFrame.halfHeight*this._scale.y:this._y+this.currentFrame.halfHeight};d.prototype.getLeft=function(){return this._scale?this._x-this.currentFrame.halfWidth*
this._scale.x:this._x-this.currentFrame.halfWidth};d.prototype.getRight=function(){return this._scale?this._x+this.currentFrame.halfWidth*this._scale.x:this._x+this.currentFrame.halfWidth};d.prototype.getWidth=function(){return this._scale?this.currentFrame.width*this._scale.x:this.currentFrame.width};d.prototype.getHeight=function(){return this._scale?this.currentFrame.height*this._scale.y:this.currentFrame.height};d.prototype.setLeft=function(a){this._x=this._scale?a+this.currentFrame.halfWidth*
this._scale.x:a+this.currentFrame.halfWidth;this.onChangeEvent.needsRedraw=!0};d.prototype.setRight=function(a){this._x=this._scale?a-this.currentFrame.halfWidth*this._scale.x:a-this.currentFrame.halfWidth;this.onChangeEvent.needsRedraw=!0};d.prototype.setTop=function(a){this._y=this._scale?a+this.currentFrame.halfHeight*this._scale.y:a+this.currentFrame.halfHeight;this.onChangeEvent.needsRedraw=!0};d.prototype.setBottom=function(a){this._y=this._scale?a-this.currentFrame.halfHeight*this._scale.y:
a-this.currentFrame.halfHeight;this.onChangeEvent.needsRedraw=!0};e.extend(d,b);g.Sprite=d})(window.Match.renderers,window.Match,window.Match.renderers.Renderizable);(function(g,e,b){function d(a){b.apply(this,arguments);this._fillStyle="black";this._lineWidth=this._strokeStyle=null;this.set(a)}d.prototype.css=function(a){a=e.getStyleBySelector(a);""!=a.color&&this.setFillStyle(a.color);""!=a.backgroundColor&&this.setFillStyle(a.backgroundColor);""!=a.borderColor&&this.setStrokeStyle(a.borderColor);""!=a.borderWidth&&this.setLineWidth(a.borderWidth);""!=a.width&&this.setWidth(a.width);""!=a.height&&this.setHeight(a.height);""!=a.left&&this.setLeft(a.left);""!=
a.right&&this.setRight(a.right);""!=a.top&&this.setTop(a.top);""!=a.bottom&&this.setBottom(a.bottom);if(""!=a.boxShadow){var b,d,g,k;-1<a.boxShadow.indexOf("rgb")?b=a.boxShadow.match(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/)[0]:a.boxShadow.indexOf("px")>a.boxShadow.indexOf(" ")&&(b=a.boxShadow.substr(0,a.boxShadow.indexOf(" ")));if(a=a.boxShadow.match(/([0-9]+px) ([0-9]+px) ([0-9]+px)/))d=parseInt(a[1]),g=parseInt(a[2]),k=parseInt(a[3]);this.setShadow(d,g,b,k)}};d.prototype.setFillStyle=function(a){this._fillStyle=
a;this._changed=!0};d.prototype.setStrokeStyle=function(a){this._strokeStyle=a;this._changed=!0};d.prototype.setStrokeWidth=function(a){this._lineWidth=a;this._changed=!0};d.prototype.setShadow=function(a,b,d,e){this._shadow={x:a,y:b,color:d||"black",blur:e||1};this._changed=!0};d.prototype.getFillStyle=function(){return this._fillStyle};d.prototype.getStrokeStyle=function(){return this._strokeStyle};d.prototype.getStrokeWidth=function(){return this._lineWidth};d.prototype.getShadow=function(){return this._shadow};
d.prototype.onRender=function(a,b,d,e){this._applyOperation(a);this._applyAlpha(a);this._rotation||this._scale?(a.save(),this._applyTranslation(a,d,e),this._applyRotation(a),this._applyScale(a),this._fillStyle&&(a.fillStyle=this._fillStyle),a.fillRect(-this._halfWidth,-this._halfHeight,this._width,this._height),this._lineWidth&&(a.lineWidth=this._lineWidth),this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.strokeRect(-this._halfWidth,-this._halfHeight,this._width,this._height)),a.restore()):(this._fillStyle&&
(a.fillStyle=this._fillStyle),a.fillRect(this._x-this._halfWidth,this._y-this._halfHeight,this._width,this._height),this._lineWidth&&(a.lineWidth=this._lineWidth),this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.strokeRect(this._x-this._halfWidth,this._y-this._halfHeight,this._width,this._height)));this._applyShadow(a)};e.extend(d,b);g.Rectangle=d})(window.Match.renderers,window.Match,window.Match.renderers.Renderizable);(function(g,e,b){function d(a){b.apply(this,arguments);this.changed=!0;this._fillStyle="rgb(0,0,0)";this._lineWidth=this._strokeStyle=null;this._radius=1;this._startAngle=0;this._endAngle=6.28;this.set(a)}d.prototype.css=function(a){a=e.getStyleBySelector(a);""!=a.color&&this.setFillStyle(a.color);""!=a.backgroundColor&&this.setFillStyle(a.backgroundColor);""!=a.borderColor&&this.setStrokeStyle(a.borderColor);""!=a.borderWidth&&this.setLineWidth(a.borderWidth);""!=a.width&&this.setRadius(a.width);
""!=a.height&&this.setRadius(a.height);""!=a.left&&this.setLeft(a.left);""!=a.right&&this.setRight(a.right);""!=a.top&&this.setTop(a.top);""!=a.bottom&&this.setBottom(a.bottom);if(""!=a.boxShadow){var b,d,g,h;-1<a.boxShadow.indexOf("rgb")?b=a.boxShadow.match(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/)[0]:a.boxShadow.indexOf("px")>a.boxShadow.indexOf(" ")&&(b=a.boxShadow.substr(0,a.boxShadow.indexOf(" ")));if(a=a.boxShadow.match(/([0-9]+px) ([0-9]+px) ([0-9]+px)/))d=parseInt(a[1]),g=parseInt(a[2]),h=
parseInt(a[3]);this.setShadow(d,g,b,h)}};d.prototype.setStrokeStyle=function(a){this._strokeStyle=a;this._changed=!0};d.prototype.getStrokeStyle=function(){return this._strokeStyle};d.prototype.setFillStyle=function(a){this._fillStyle=a;this._changed=!0};d.prototype.getFillStyle=function(){return this._fillStyle};d.prototype.setStrokeWidth=function(a){this._lineWidth=a;this._changed=!0};d.prototype.getStrokeWidth=function(){return this._lineWidth};d.prototype.setRadius=function(a){this._radius=a;
this._changed=!0};d.prototype.setShadow=function(a,b,d,e){this._shadow={x:a,y:b,color:d||"black",blur:e||1};this._changed=!0};d.prototype.getShadow=function(){return this._shadow};d.prototype.getRadius=function(){return this._radius};d.prototype.isMouseOver=function(a){a||(a=e.onLoopProperties);return e.Math2d.getDistance({x:this._x,y:this._y},a.mouse)<=this._radius};d.prototype.getWidth=function(){return this._scale?this._radius*this._scale.x:this._radius};d.prototype.getHeight=function(){return this._scale?
this._radius*this._scale.y:this._radius};d.prototype.getLeft=function(){return this._scale?this._x-this._radius*this._scale.x:this._x-this._radius};d.prototype.getRight=function(){return this._scale?this._x+this._radius*this._scale.x:this._x+this._radius};d.prototype.getTop=function(){return this._scale?this._y-this._radius*this._scale.y:this._y-this._radius};d.prototype.getBottom=function(){return this._scale?this._y+this._radius*this._scale.y:this._y+this._radius};d.prototype.setLeft=function(a){this._x=
this._scale?a+this._radius*this._scale.x:a+this._radius;this._changed=!0};d.prototype.setRight=function(a){this._x=this._scale?a-this._radius*this._scale.x:a-this._radius;this._changed=!0};d.prototype.setTop=function(a){this._y=this._scale?a+this._radius*this._scale.y:a+this._radius;this._changed=!0};d.prototype.setBottom=function(a){this._y=this._scale?a-this._radius*this._scale.y:a-this._radius;this._changed=!0};d.prototype.buffers={b:[],c:0};for(var a=0;9>a;a++){var h=document.createElement("canvas").getContext("2d");
h.elements=0;h.maxElements=600;h.canvas.width=3E4;h.canvas.height=50;d.prototype.buffers.b.push(h)}d.prototype.save=function(){var a=this.buffers.b[this.buffers.c];a.elements+1>a.maxElements&&(this.buffers.c++,a=this.buffers.b[this.buffers.c]);a.save();this._applyAlpha(a);a.translate(this._radius,this._radius);this._applyScale(a);this._applyShadow(a);this._lineWidth&&(a.lineWidth=this._lineWidth);a.beginPath();a.arc(2*a.elements*this._radius,0,this._radius,this._startAngle,this._endAngle,!1);a.closePath();
this._fillStyle&&(a.fillStyle=this._fillStyle,a.fill());this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.stroke(-this._radius,-this._radius,this._width,this._height));this.img=a.canvas;this.changed=!1;this.elementNumber=a.elements;a.elements++;a.restore()};d.prototype.onRender=function(a,b,d,e){this.changed&&this.save();b=2*this._radius;a.drawImage(this.img,this.elementNumber*b,0,b,b,this._x-this._radius,this._y-this._radius,b,b)};e.extend(d,b);g.Circle=d})(window.Match.renderers,window.Match,
window.Match.renderers.Renderizable);(function(g,e,b){function d(a){b.apply(this,arguments);this._weight=this._variant=this._style="";this._size="14px";this._family="Calibri, Verdana, Arial, Monospace";this._textAlign="center";this._textBaseline="middle";this._text="";this.set(a)}d.prototype.onRender=function(a,b,d,e){a.save();this._applyShadow(a);this._applyAlpha(a);this._applyTranslation(a,d,e);this._applyRotation(a);this._applyScale(a);a.font=this._style+this._variant+this._weight+this._size+this._family;a.textAlign=this._textAlign;
a.textBaseline=this._textBaseline;a.fillStyle=this._fillStyle;if(this.multiLine)for(b=0;b<this.multiLine.length;b++)a.fillText(this.multiLine[b],0,b*this.getHeight());else a.fillText(this._text,0,0);this._strokeStyle&&(a.strokeStyle=this._strokeStyle,a.lineWidth=this._lineWidth||1,a.strokeText(this._text,0,0));a.restore()};d.prototype.getRight=function(){return this._x+this.getWidth()};d.prototype.getBottom=function(){return this._y+this.getHeight()};d.prototype.getHeight=function(){if(this._text==
this._cachedText2)return this._height;var a=document.createElement("span"),b;a.font=this._style+this._variant+this._weight+this._size+this._family;a.textContent=this._text;document.body.appendChild(a);b=a.offsetHeight;document.body.removeChild(a);this._height=b;this._cachedText2=this._text;return b};d.prototype.setAlignment=function(a,b){this.setHorizontalAlign(a);this.setVerticalAlign(b)};d.prototype.setHorizontalAlign=function(a){this._textAlign=a;this.onChangeEvent.needsRedraw=!0};d.prototype.setVerticalAlign=
function(a){this._textBaseline=a;this.onChangeEvent.needsRedraw=!0};d.prototype.getWidth=function(){if(this._text==this._cachedText)return this._width;var a,b=e.offScreenContext;b.save();b.font=this._style+this._variant+this._weight+this._size+this._family;b.fillStyle=this._fillStyle;a=b.measureText(this._text).width;b.restore();this._width=a;this._cachedText=this._text;return a};d.prototype.setFamily=function(a){this._family=a;this.onChangeEvent.needsRedraw=!0};d.prototype.setSize=function(a){this._size=
parseInt(a)+"px ";this.onChangeEvent.needsRedraw=!0};d.prototype.setWeight=function(a){this._weight=a+" ";this.onChangeEvent.needsRedraw=!0};d.prototype.setVariant=function(a){this._variant=a+" ";this.onChangeEvent.needsRedraw=!0};d.prototype.setStyle=function(a){this._style=a+" ";this.onChangeEvent.needsRedraw=!0};d.prototype.setFillStyle=function(a){this._fillStyle=a;this.onChangeEvent.needsRedraw=!0};d.prototype.css=function(a){a=e.getStyleBySelector(a);""!=a.color&&this.setFillStyle(a.color);
""!=a.fontFamily&&this.setFamily(a.fontFamily);""!=a.fontSize&&this.setSize(a.fontSize);""!=a.fontStyle&&this.setStyle(a.fontStyle);""!=a.fontVariant&&this.setVariant(a.fontVariant);""!=a.fontWeight&&this.setWeight(a.fontWeight);""!=a.left&&this.setLeft(a.left);""!=a.right&&this.setRight(a.right);""!=a.top&&this.setTop(a.top);""!=a.bottom&&this.setBottom(a.bottom);if(""!=a.textShadow){var b,d,g,k;-1<a.textShadow.indexOf("rgb")?b=a.textShadow.match(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/)[0]:a.textShadow.indexOf("px")>
a.textShadow.indexOf(" ")&&(b=a.textShadow.substr(0,a.textShadow.indexOf(" ")));if(a=a.textShadow.match(/([0-9]+px) ([0-9]+px) ([0-9]+px)/))d=parseInt(a[1]),g=parseInt(a[2]),k=parseInt(a[3]);this.setShadow(d,g,b,k)}};d.prototype.getSize=function(a){return this._size};d.prototype.getWeight=function(a){return this._weight};d.prototype.getVariant=function(a){return this._variant};d.prototype.getStyle=function(a){return this._style};d.prototype.setStrokeStyle=function(a){this._strokeStyle=a;this.onChangeEvent.needsRedraw=
!0};d.prototype.setStrokeWidth=function(a){this._lineWidth=a;this._changed=!0};d.prototype.getStrokeWidth=function(){return this._lineWidth};d.prototype.setText=function(a,b){b&&(this.multiLine=a.split("\n"));this._text=a;this.onChangeEvent.needsRedraw=!0};d.prototype.getFamily=function(a){return this._family};d.prototype.getFillStyle=function(a){return this._fillStyle};d.prototype.getStrokeStyle=function(a){return this._strokeStyle};d.prototype.getText=function(){return this._text};d.prototype.setShadow=
function(a,b,d,e){this._shadow={x:a,y:b,color:d||"black",blur:e||1};this.onChangeEvent.needsRedraw=!0};d.prototype.getShadow=function(){return this._shadow};e.extend(d,b);g.Text=d})(window.Match.renderers,window.Match,window.Match.renderers.Renderizable);
